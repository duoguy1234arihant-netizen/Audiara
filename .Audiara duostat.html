<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Analytics Dashboard Pro</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@1.2.1/dist/chartjs-plugin-zoom.min.js"></script>
    <style>
        :root {
            --primary-color: #6C63FF;
            --secondary-color: #4A44C6;
            --success-color: #36D399;
            --warning-color: #FBBD23;
            --danger-color: #F87272;
            --info-color: #3ABFF8;
            --dark-color: #1F2937;
            --light-color: #F9FAFB;
            --bg-color: #0F172A;
            --card-bg: rgba(255, 255, 255, 0.1);
            --text-color: #E2E8F0;
            --text-secondary: #94A3B8;
            --border-color: rgba(255, 255, 255, 0.2);
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            --transition: all 0.3s ease;
            --gradient-primary: linear-gradient(135deg, #6C63FF, #4A44C6);
            --gradient-success: linear-gradient(135deg, #36D399, #2ACF8B);
            --gradient-warning: linear-gradient(135deg, #FBBD23, #F59E0B);
            --gradient-danger: linear-gradient(135deg, #F87272, #EF4444);
            --gradient-info: linear-gradient(135deg, #3ABFF8, #0EA5E9);
        }

        .light-theme {
            --bg-color: #F1F5F9;
            --card-bg: rgba(255, 255, 255, 0.9);
            --text-color: #1E293B;
            --text-secondary: #64748B;
            --border-color: rgba(0, 0, 0, 0.1);
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: var(--transition);
            min-height: 100vh;
            padding: 20px;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(108, 99, 255, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(74, 68, 198, 0.1) 0%, transparent 20%);
            overflow-x: hidden;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            margin-bottom: 30px;
            border-bottom: 1px solid var(--border-color);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: var(--gradient-primary);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
        }

        .logo-text h1 {
            font-size: 28px;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-weight: 700;
        }

        .logo-text p {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        /* Theme Toggle */
        .theme-toggle {
            position: relative;
            width: 70px;
            height: 32px;
            background: var(--card-bg);
            border-radius: 50px;
            cursor: pointer;
            border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
            transition: var(--transition);
        }

        .theme-toggle:before {
            content: '';
            position: absolute;
            width: 26px;
            height: 26px;
            border-radius: 50%;
            background: var(--primary-color);
            top: 2px;
            left: 3px;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            color: white;
        }

        .theme-toggle.active:before {
            transform: translateX(38px);
            background: var(--warning-color);
        }

        .theme-toggle i {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            font-size: 14px;
            color: var(--text-color);
        }

        .theme-toggle .fa-sun {
            left: 10px;
        }

        .theme-toggle .fa-moon {
            right: 10px;
        }

        /* Date Range Selector */
        .date-range-selector {
            display: flex;
            background: var(--card-bg);
            border-radius: 12px;
            padding: 5px;
            border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
        }

        .date-range-btn {
            padding: 8px 20px;
            border-radius: 8px;
            border: none;
            background: transparent;
            color: var(--text-color);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
        }

        .date-range-btn.active {
            background: var(--primary-color);
            color: white;
        }

        /* Glassmorphism Cards */
        .card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow);
            transition: var(--transition);
            height: 100%;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 20px;
            font-weight: 600;
        }

        .card-subtitle {
            color: var(--text-secondary);
            font-size: 14px;
            margin-top: 5px;
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
        }

        .stat-info h3 {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-info p {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .stat-change {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
            margin-top: 5px;
        }

        .stat-change.positive {
            color: var(--success-color);
        }

        .stat-change.negative {
            color: var(--danger-color);
        }

        .stat-change-value {
            font-weight: 600;
            margin-right: 5px;
        }

        /* Charts Section */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(600px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-container {
            position: relative;
            height: 350px;
        }

        .chart-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .chart-type-btn {
            padding: 8px 20px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            background: var(--card-bg);
            color: var(--text-color);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
        }

        .chart-type-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        /* Heatmap Controls */
        .heatmap-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }



        /* Table */
        .table-container {
            overflow-x: auto;
            margin-bottom: 30px;
            border-radius: 15px;
            border: 1px solid var(--border-color);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            border-radius: 15px;
            overflow: hidden;
        }

        .data-table th {
            background: rgba(108, 99, 255, 0.2);
            padding: 15px;
            text-align: left;
            font-weight: 600;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            user-select: none;
            position: relative;
        }

        .data-table th i {
            margin-left: 5px;
            opacity: 0.5;
            transition: var(--transition);
        }

        .data-table th:hover i {
            opacity: 1;
        }

        .data-table th.sorted-asc i.fa-sort-up,
        .data-table th.sorted-desc i.fa-sort-down {
            opacity: 1;
            color: var(--primary-color);
        }

        .data-table td {
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .data-table tr:last-child td {
            border-bottom: none;
        }

        .data-table tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        /* Table Search */
        .table-search {
            position: relative;
        }

        .table-search input {
            padding: 10px 40px 10px 15px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            background: var(--card-bg);
            color: var(--text-color);
            width: 250px;
            transition: var(--transition);
        }

        .table-search input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(108, 99, 255, 0.2);
        }

        .table-search i {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
        }

        /* Achievements */
        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .achievement-card {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .achievement-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            flex-shrink: 0;
        }

        .achievement-info h4 {
            font-size: 16px;
            margin-bottom: 5px;
        }

        .achievement-info p {
            color: var(--text-secondary);
            font-size: 14px;
            margin-bottom: 10px;
        }

        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient-primary);
            border-radius: 10px;
            transition: width 1s ease;
        }

        /* Streak */
        .streak-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .streak-card {
            text-align: center;
            padding: 30px;
            min-width: 200px;
        }

        .streak-count {
            font-size: 48px;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(90deg, var(--warning-color), var(--danger-color));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .streak-label {
            color: var(--text-secondary);
            font-size: 16px;
        }

        .streak-fire {
            color: var(--warning-color);
            font-size: 24px;
            margin-right: 10px;
        }

        /* Notifications */
        .notification-badge {
            position: relative;
        }

        .notification-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--danger-color);
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        /* Advanced Analytics */
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .analytics-card {
            text-align: center;
        }

        .analytics-value {
            font-size: 42px;
            font-weight: 700;
            margin-bottom: 10px;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .analytics-label {
            color: var(--text-secondary);
            font-size: 16px;
            margin-bottom: 15px;
        }

        .analytics-desc {
            color: var(--text-color);
            font-size: 14px;
            line-height: 1.5;
        }

        /* Progress Rings */
        .progress-ring {
            position: relative;
            width: 120px;
            height: 120px;
            margin: 0 auto 20px;
        }

        .progress-ring-circle {
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }

        .progress-ring-bg {
            fill: none;
            stroke: rgba(255, 255, 255, 0.1);
            stroke-width: 8;
        }

        .progress-ring-fill {
            fill: none;
            stroke: var(--primary-color);
            stroke-width: 8;
            stroke-linecap: round;
            stroke-dasharray: 283;
            stroke-dashoffset: 283;
            transition: stroke-dashoffset 1s ease;
        }

        .progress-ring-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            font-weight: 700;
        }

        /* Heatmap */
        .heatmap-container {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            margin-top: 20px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 15px;
        }



 
        /* Footer */
        .footer {
            text-align: center;
            padding: 20px;
            color: var(--text-secondary);
            font-size: 14px;
            border-top: 1px solid var(--border-color);
            margin-top: 30px;
        }

        /* Toast */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: var(--shadow);
            z-index: 1000;
            transform: translateX(150%);
            transition: transform 0.3s ease;
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            max-width: 350px;
        }

        .toast-success {
            background: rgba(54, 211, 153, 0.9);
            color: white;
        }

        .toast-info {
            background: rgba(58, 191, 248, 0.9);
            color: white;
        }

        .toast-warning {
            background: rgba(251, 189, 35, 0.9);
            color: white;
        }

        .toast-error {
            background: rgba(248, 114, 114, 0.9);
            color: white;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-color);
            font-size: 24px;
            cursor: pointer;
            transition: var(--transition);
        }

        .modal-close:hover {
            color: var(--danger-color);
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .analytics-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 20px;
            }
            
            .header-controls {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .achievements-grid {
                grid-template-columns: 1fr;
            }
            
            .streak-container {
                flex-direction: column;
            }
            
            .streak-card {
                width: 100%;
            }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--secondary-color);
        }

        /* Animations */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }

        /* Additional Features */
        .export-btn, .notification-btn, .settings-btn, .analytics-btn {
            width: 45px;
            height: 45px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            color: var(--text-color);
            cursor: pointer;
            transition: var(--transition);
            backdrop-filter: blur(10px);
        }

        .export-btn:hover, .notification-btn:hover, .settings-btn:hover, .analytics-btn:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-3px);
        }

        .quick-stats {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .quick-stat {
            padding: 15px 25px;
            border-radius: 15px;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
            min-width: 150px;
            transition: var(--transition);
        }

        .quick-stat:hover {
            transform: translateY(-3px);
        }

        .quick-stat h4 {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        .quick-stat p {
            font-size: 24px;
            font-weight: 700;
        }

        .data-point-highlight {
            background: rgba(108, 99, 255, 0.2);
            border-radius: 8px;
            padding: 3px 10px;
            font-weight: 600;
        }

        .trend-indicator {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 3px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .trend-up {
            background: rgba(54, 211, 153, 0.2);
            color: var(--success-color);
        }

        .trend-down {
            background: rgba(248, 114, 114, 0.2);
            color: var(--danger-color);
        }

        .trend-neutral {
            background: rgba(58, 191, 248, 0.2);
            color: var(--info-color);
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            background: transparent;
            color: var(--text-color);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
        }

        .tab-btn.active {
            background: var(--primary-color);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        /* Loading Spinner */
        .loading-spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Heatmap Months */
        .heatmap-months {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .heatmap-weekdays {
            display: grid;
            grid-template-rows: repeat(7, 1fr);
            gap: 5px;
            margin-right: 10px;
            font-size: 11px;
            color: var(--text-secondary);
        }

        .heatmap-content {
            display: flex;
            gap: 10px;
        }

        /* Heatmap Month View */
        .heatmap-month-view {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 4px;
    margin: 20px 0;
    padding: 15px;
    background: rgba(0, 0, 0, 0.05);
    border-radius: 12px;
    border: 1px solid var(--border-color);
}

.heatmap-month-title {
    grid-column: 1 / -1;
    text-align: center;
    font-size: 16px;
    font-weight: 600;
    margin-bottom: 15px;
    color: var(--text-color);
    padding: 10px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 8px;
}

        .heatmap-month-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }

 


        /* Prediction Cards */
        .prediction-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .prediction-card {
            padding: 20px;
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
        }

        .prediction-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--text-color);
        }

        .prediction-value {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .prediction-metric {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .prediction-metric span {
            color: var(--text-color);
            font-weight: 600;
        }

        /* Heatmap Year Container */
    
        /* Stats Badge */
        .stats-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 10px;
        }

        .stats-badge.positive {
            background: rgba(54, 211, 153, 0.2);
            color: var(--success-color);
        }

        .stats-badge.negative {
            background: rgba(248, 114, 114, 0.2);
            color: var(--danger-color);
        }



        /* Heatmap Layout Fixes */
.heatmap-month-view {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 4px;
    margin: 20px 0;
    padding: 15px;
    background: rgba(0, 0, 0, 0.05);
    border-radius: 12px;
    border: 1px solid var(--border-color);
}

.heatmap-month-title {
    grid-column: 1 / -1;
    text-align: center;
    font-size: 16px;
    font-weight: 600;
    margin-bottom: 15px;
    color: var(--text-color);
    padding: 10px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 8px;
}

.heatmap-day-of-week {
    text-align: center;
    font-size: 11px;
    font-weight: 500;
    color: var(--text-secondary);
    padding: 8px 4px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.heatmap-day {
    width: 100%;
    aspect-ratio: 1;
    border-radius: 6px;
    transition: all 0.2s ease;
    position: relative;
    cursor: pointer;
    border: 1px solid transparent;
}

.heatmap-day:hover {
    transform: scale(1.15);
    z-index: 10;
    border-color: var(--text-color);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

.heatmap-day:hover::after {
    content: attr(data-tooltip);
    position: absolute;
    bottom: 125%;
    left: 50%;
    transform: translateX(-50%);
    background: var(--card-bg);
    color: var(--text-color);
    padding: 10px 14px;
    border-radius: 8px;
    font-size: 12px;
    white-space: nowrap;
    z-index: 100;
    border: 1px solid var(--border-color);
    backdrop-filter: blur(10px);
    box-shadow: var(--shadow);
    min-width: 150px;
    text-align: center;
    pointer-events: none;
}

.heatmap-day:hover::before {
    content: '';
    position: absolute;
    bottom: 115%;
    left: 50%;
    transform: translateX(-50%);
    border-width: 6px;
    border-style: solid;
    border-color: var(--card-bg) transparent transparent transparent;
    z-index: 101;
}

.heatmap-empty-day {
    width: 100%;
    aspect-ratio: 1;
    background: transparent;
    border-radius: 6px;
    border: 1px dashed rgba(255, 255, 255, 0.1);
}

.heatmap-year-container {
    display: flex;
    flex-direction: column;
    gap: 30px;
    padding: 20px 0;
}

.heatmap-month-container {
    background: rgba(255, 255, 255, 0.03);
    border-radius: 12px;
    padding: 15px;
    border: 1px solid var(--border-color);
}

.heatmap-month-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 1px solid var(--border-color);
}

.heatmap-month-name {
    font-size: 18px;
    font-weight: 600;
    color: var(--text-color);
}

.heatmap-month-stats {
    font-size: 14px;
    color: var(--text-secondary);
    background: rgba(108, 99, 255, 0.1);
    padding: 4px 12px;
    border-radius: 20px;
}

.heatmap-days-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 4px;
}

/* Improved Month Filter */
.month-filter {
    display: flex;
    gap: 8px;
    margin-bottom: 25px;
    padding: 15px;
    background: rgba(255, 255, 255, 0.03);
    border-radius: 12px;
    border: 1px solid var(--border-color);
    flex-wrap: wrap;
    justify-content: center;
}

.month-btn {
    padding: 8px 16px;
    border-radius: 8px;
    border: 1px solid var(--border-color);
    background: var(--card-bg);
    color: var(--text-color);
    cursor: pointer;
    transition: var(--transition);
    font-size: 13px;
    font-weight: 500;
    min-width: 90px;
    text-align: center;
}

.month-btn:hover {
    background: rgba(108, 99, 255, 0.1);
    border-color: var(--primary-color);
}

.month-btn.active {
    background: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
    box-shadow: 0 4px 12px rgba(108, 99, 255, 0.3);
}

/* Enhanced Heatmap Legend */
.heatmap-legend {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 20px;
    margin-top: 30px;
    padding: 20px;
    background: rgba(255, 255, 255, 0.03);
    border-radius: 12px;
    border: 1px solid var(--border-color);
    flex-wrap: wrap;
}

.heatmap-legend-item {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 12px;
    font-weight: 500;
}

.heatmap-legend-color {
    width: 20px;
    height: 20px;
    border-radius: 6px;
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.heatmap-legend-label {
    color: var(--text-secondary);
    white-space: nowrap;
}

/* Responsive Heatmap */
@media (max-width: 768px) {
    .heatmap-month-view {
        gap: 3px;
        padding: 10px;
    }
    
    .heatmap-day-of-week {
        font-size: 10px;
        padding: 6px 2px;
    }
    
    .month-btn {
        padding: 6px 12px;
        min-width: 70px;
        font-size: 12px;
    }
    
    .heatmap-legend {
        gap: 10px;
        padding: 15px;
    }
    
    .heatmap-legend-item {
        font-size: 11px;
    }
    
    .heatmap-legend-color {
        width: 16px;
        height: 16px;
    }
}

@media (max-width: 480px) {
    .heatmap-month-view {
        gap: 2px;
    }
    
    .heatmap-day-of-week {
        font-size: 9px;
        padding: 4px 1px;
    }
    
    .month-btn {
        padding: 5px 8px;
        min-width: 60px;
        font-size: 11px;
    }
    
    .heatmap-day:hover::after {
        font-size: 11px;
        padding: 8px 12px;
        min-width: 130px;
    }
}

/* Heatmap Color Intensity Indicators */
.heatmap-intensity-label {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 10px;
    font-weight: 600;
    color: white;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
    pointer-events: none;
}

/* Scrollable Heatmap Container */
.heatmap-scroll-container {
    overflow-x: auto;
    padding: 20px;
    margin: -20px;
}

.heatmap-scroll-container::-webkit-scrollbar {
    height: 8px;
}

.heatmap-scroll-container::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 4px;
}

.heatmap-scroll-container::-webkit-scrollbar-thumb {
    background: var(--primary-color);
    border-radius: 4px;
}

/* Heatmap Tooltip Enhancements */
.heatmap-tooltip-content {
    display: flex;
    flex-direction: column;
    gap: 4px;
    text-align: center;
}

.heatmap-tooltip-date {
    font-weight: 600;
    font-size: 13px;
    margin-bottom: 2px;
}

.heatmap-tooltip-value {
    font-size: 12px;
    opacity: 0.9;
}

.heatmap-tooltip-status {
    font-size: 11px;
    padding: 2px 8px;
    border-radius: 10px;
    background: rgba(255, 255, 255, 0.1);
    display: inline-block;
    margin-top: 4px;
}

/* Animation for heatmap cells */
@keyframes heatmapPulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
}

.heatmap-day.recent {
    animation: heatmapPulse 2s infinite;
    box-shadow: 0 0 0 2px rgba(108, 99, 255, 0.3);
}

/* Heatmap loading state */
.heatmap-loading {
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 300px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    border: 1px dashed var(--border-color);
}

.heatmap-loading-spinner {
    width: 40px;
    height: 40px;
    border: 3px solid rgba(255, 255, 255, 0.1);
    border-top-color: var(--primary-color);
    border-radius: 50%;
    animation: spin 1s ease-in-out infinite;
}
/* Minimized Heatmap Day Sizes */
.heatmap-month-view {
    grid-template-columns: repeat(7, 1fr);
    gap: 2px;
    padding: 10px;
    margin: 10px 0;
}

.heatmap-day-of-week {
    padding: 4px 1px;
    font-size: 10px;
    height: 20px;
}

.heatmap-day {
    width: 20px;
    height: 20px;
    min-width: 20px;
    min-height: 20px;
    aspect-ratio: 1;
    border-radius: 3px;
}

.heatmap-empty-day {
    width: 20px;
    height: 20px;
    min-width: 20px;
    min-height: 20px;
}

.heatmap-month-title {
    margin-bottom: 8px;
    padding: 8px;
    font-size: 14px;
}

/* Smaller hover effects for small cells */
.heatmap-day:hover {
    transform: scale(1.3);
    z-index: 20;
}

.heatmap-day:hover::after {
    font-size: 11px;
    padding: 8px 10px;
    min-width: 120px;
    bottom: 140%;
    white-space: normal;
    max-width: 150px;
    word-wrap: break-word;
}

/* Compact month filter */
.month-filter {
    padding: 10px;
    gap: 5px;
    margin-bottom: 15px;
}

.month-btn {
    padding: 4px 8px;
    min-width: 60px;
    font-size: 11px;
}

/* Compact legend */
.heatmap-legend {
    padding: 12px;
    gap: 12px;
    margin-top: 15px;
}

.heatmap-legend-item {
    font-size: 11px;
    gap: 4px;
}

.heatmap-legend-color {
    width: 14px;
    height: 14px;
}

/* Even smaller for mobile */
@media (max-width: 768px) {
    .heatmap-day {
        width: 16px;
        height: 16px;
        min-width: 16px;
        min-height: 16px;
    }
    
    .heatmap-empty-day {
        width: 16px;
        height: 16px;
        min-width: 16px;
        min-height: 16px;
    }
    
    .heatmap-day-of-week {
        font-size: 9px;
        padding: 2px 0;
        height: 16px;
    }
    
    .heatmap-month-title {
        font-size: 12px;
        padding: 6px;
    }
    
    .heatmap-day:hover {
        transform: scale(1.5);
    }
}

@media (max-width: 480px) {
    .heatmap-day {
        width: 14px;
        height: 14px;
        min-width: 14px;
        min-height: 14px;
    }
    
    .heatmap-empty-day {
        width: 14px;
        height: 14px;
        min-width: 14px;
        min-height: 14px;
    }
    
    .heatmap-day-of-week {
        font-size: 8px;
        height: 14px;
    }
    
    .heatmap-month-view {
        gap: 1px;
        padding: 8px;
    }
}

/* Ensure tooltip is readable even with small cells */
.heatmap-day:hover::before {
    bottom: 135%;
    border-width: 4px;
}



















:root {
    /* ────────────────────────────────────────────── */
    /*          Shared variables                     */
    /* ────────────────────────────────────────────── */
    --radius-sm:      12px;
    --radius:         18px;
    --radius-lg:      28px;

    --transition:     all 0.26s cubic-bezier(0.34, 1.56, 0.64, 1);

    --blur-strong:    blur(20px) saturate(1.6);
    --blur-medium:    blur(14px) saturate(1.45);
    --blur-light:     blur(10px) saturate(1.3);

    --shadow-soft:    0 8px 32px rgba(0,0,0,0.10);
    --shadow-strong:  0 16px 48px rgba(0,0,0,0.18);
}

/* ────────────────────────────────────────────── */
/*                  DARK THEME                    */
/* ────────────────────────────────────────────── */
:root {
    --bg-body:              #05070f;
    --bg-gradient:          linear-gradient(145deg, #0b1121 0%, #000306 100%);

    --glass-bg:             rgba(18, 22, 38, 0.18);       /* ← lowered a lot */
    --glass-border:         rgba(180,190,255,0.07);
    --glass-border-strong:  rgba(180,190,255,0.14);

    --text-primary:         #f8fafc;
    --text-secondary:       #cbd5e1;
    --text-muted:           #64748b;

    --accent:               #7c3aed;
    --accent-glow:          rgba(124, 58, 237, 0.22);

    --success:              #10b981;
    --warning:              #f59e0b;
    --danger:               #f87171;

    --card-shadow:          var(--shadow-soft);
    --hover-glow:           0 0 34px rgba(124,58,237,0.20);
}

/* ────────────────────────────────────────────── */
/*                  LIGHT THEME                   */
/* ────────────────────────────────────────────── */
.light-theme {
    --bg-body:              #fafcff;
    --bg-gradient:          linear-gradient(145deg, #f1f5f9 0%, #e0e7ff 100%);

    --glass-bg:             rgba(255, 255, 255, 0.42);    /* ← more transparent */
    --glass-border:         rgba(30,40,70,0.06);
    --glass-border-strong:  rgba(30,40,70,0.11);

    --text-primary:         #0f172a;
    --text-secondary:       #475569;
    --text-muted:           #64748b;

    --accent:               #7c3aed;
    --accent-glow:          rgba(124, 58, 237, 0.14);

    --success:              #059669;
    --warning:              #d97706;
    --danger:               #dc2626;

    --card-shadow:          0 10px 40px rgba(0,0,0,0.06);
    --hover-glow:           0 0 30px rgba(124,58,237,0.12);
}

/* ────────────────────────────────────────────── */
/*                  BODY & LAYERS                 */
/* ────────────────────────────────────────────── */

body {
    background: var(--bg-body);
    background-image:
        url('backdef.jpg'),
        var(--bg-gradient);
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
    color: var(--text-primary);
    min-height: 100vh;
    position: relative;
    padding: 28px 16px;
}
/* ────────────────────────────────────────────── */
/*                  BODY & BACKGROUND             */
/* ────────────────────────────────────────────── */


/* Light theme uses different background image */
.light-theme {
    background-image:
        url('backdef2.png'),
        var(--bg-gradient);
}

/* Glass overlay — stronger blur for more transparency feel */
body::before {
    content: "";
    position: fixed;
    inset: 0;
    background: inherit;
    background-attachment: fixed;
    backdrop-filter: var(--blur-strong);           /* 20px blur */
    -webkit-backdrop-filter: var(--blur-strong);
    z-index: -2;
}

/* Overlay gradient – kept very light in both modes for max transparency */
body::after {
    content: "";
    position: fixed;
    inset: 0;
    background: linear-gradient(to bottom, rgba(0,0,0,0.09), rgba(0,0,0,0.32));
    z-index: -1;
}

.light-theme::after {
    background: linear-gradient(to bottom, rgba(255,255,255,0.03), rgba(255,255,255,0.14));
}
/* Stronger blur, lighter overlay */
body::before {
    content: "";
    position: fixed;
    inset: 0;
    background: inherit;
    background-attachment: fixed;
    backdrop-filter: var(--blur-strong);
    -webkit-backdrop-filter: var(--blur-strong);
    z-index: -2;
}

body::after {
    content: "";
    position: fixed;
    inset: 0;
    background: linear-gradient(to bottom, rgba(0,0,0,0.10), rgba(0,0,0,0.36));
    z-index: -1;
}

.light-theme::after {
    background: linear-gradient(to bottom, rgba(255,255,255,0.04), rgba(255,255,255,0.18));
}

/* ────────────────────────────────────────────── */
/*                  CARDS – very transparent      */
/* ────────────────────────────────────────────── */

.card,
.card-hoverable {
    background: var(--glass-bg);
    backdrop-filter: var(--blur-medium);
    -webkit-backdrop-filter: var(--blur-medium);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-lg);
    box-shadow: var(--card-shadow);
    transition: var(--transition);
}

.card-hoverable:hover {
    transform: translateY(-8px) scale(1.008);
    box-shadow: var(--card-shadow), var(--hover-glow);
    border-color: var(--glass-border-strong);
    background: rgba(30, 35, 55, 0.24);          /* dark mode hover */
}

.light-theme .card-hoverable:hover {
    background: rgba(255, 255, 255, 0.58);
}

/* ────────────────────────────────────────────── */
/*                  BUTTONS – more see-through    */
/* ────────────────────────────────────────────── */

.chart-type-btn,
.date-range-btn,
.month-btn,
.tab-btn {
    padding: 10px 20px;
    border-radius: 12px;
    border: 1px solid var(--glass-border);
    background: rgba(30,41,59,0.14);
    color: var(--text-secondary);
    backdrop-filter: var(--blur-light);
    transition: var(--transition);
}

.light-theme .chart-type-btn,
.light-theme .date-range-btn,
.light-theme .month-btn,
.light-theme .tab-btn {
    background: rgba(255,255,255,0.38);
}

.chart-type-btn.active,
.date-range-btn.active,
.month-btn.active,
.tab-btn.active {
    background: var(--accent);
    color: white;
    border-color: transparent;
    box-shadow: 0 0 24px var(--accent-glow);
}

/* Theme toggle – glassier */
.theme-toggle {
    background: rgba(30,41,59,0.22);
    border: 1px solid var(--glass-border);
}

.light-theme .theme-toggle {
    background: rgba(241,245,249,0.48);
}

/* ────────────────────────────────────────────── */
/*                  TABLE – transparent rows      */
/* ────────────────────────────────────────────── */

.data-table th {
    background: rgba(30,41,59,0.26);
}

.light-theme .data-table th {
    background: rgba(241,245,249,0.58);
}

.data-table td {
    background: rgba(15,23,42,0.14);
}

.light-theme .data-table td {
    background: rgba(255,255,255,0.32);
}

.data-table tr:hover td {
    background: rgba(30,41,59,0.32);
}

.light-theme .data-table tr:hover td {
    background: rgba(226,232,240,0.48);
}

/* ────────────────────────────────────────────── */
/*                  HEATMAP DAYS                  */
/* ────────────────────────────────────────────── */

.heatmap-day {
    border: 1px solid rgba(255,255,255,0.06);
    backdrop-filter: blur(6px);
}

.light-theme .heatmap-day {
    border-color: rgba(0,0,0,0.05);
}

.heatmap-day:hover {
    transform: scale(1.22);
    box-shadow: 0 0 28px rgba(0,0,0,0.3);
    backdrop-filter: blur(12px);
}
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-chart-line"></i>
                </div>
                <div class="logo-text">
                    <h1>Analytics Pro</h1>
                    <p>Advanced Growth Intelligence Dashboard</p>
                </div>
            </div>
            <div class="header-controls">
                <div class="date-range-selector">
                    <button class="date-range-btn active" data-range="weekly">Weekly</button>
                    <button class="date-range-btn" data-range="monthly">Monthly</button>
                    <button class="date-range-btn" data-range="yearly">Yearly</button>
                    <button class="date-range-btn" data-range="lifetime">Lifetime</button>
                </div>
                <button class="export-btn notification-badge" title="Export Data" id="exportBtn">
                    <i class="fas fa-download"></i>
                    <span class="notification-count">3</span>
                </button>
                <button class="notification-btn notification-badge" title="Notifications" id="notificationBtn">
                    <i class="fas fa-bell"></i>
                    <span class="notification-count">5</span>
                </button>
                <button class="analytics-btn" title="Advanced Analytics" id="analyticsBtn">
                    <i class="fas fa-chart-bar"></i>
                </button>
                <button class="settings-btn" title="Settings" id="settingsBtn">
                    <i class="fas fa-cog"></i>
                </button>
                <div class="theme-toggle" id="themeToggle">
                    <i class="fas fa-sun"></i>
                    <i class="fas fa-moon"></i>
                </div>
            </div>
        </header>

        <!-- Quick Stats -->
        <div class="quick-stats">
            <div class="quick-stat">
                <h4>Current Streak</h4>
                <p id="currentStreak">0 days</p>
            </div>
            <div class="quick-stat">
                <h4>Max Streak</h4>
                <p id="maxStreak">0 days</p>
            </div>
            <div class="quick-stat">
                <h4>Avg Daily XP</h4>
                <p id="avgXP">0</p>
            </div>
            <div class="quick-stat">
                <h4>Total Followers Gain</h4>
                <p id="totalFollowersGain">0</p>
            </div>
            <div class="quick-stat">
                <h4>Best Day XP</h4>
                <p id="bestDayXP">0</p>
            </div>
            <div class="quick-stat">
                <h4>Streak Freezes Used</h4>
                <p id="streakFreezes">0</p>
            </div>
        </div>

        <!-- Stats Grid -->
        <div class="stats-grid">
            <div class="card stat-card">
                <div class="stat-icon" style="background: var(--gradient-primary);">
                    <i class="fas fa-users"></i>
                </div>
                <div class="stat-info">
                    <h3 id="totalFollowers">0</h3>
                    <p>Total Followers</p>
                    <div class="stat-change" id="followersChangeContainer">
                        <i class="fas fa-arrow-up"></i>
                        <span class="stat-change-value" id="followersChange">+0</span>
                        <span id="followersPeriod">this month</span>
                    </div>
                </div>
            </div>
            <div class="card stat-card">
                <div class="stat-icon" style="background: var(--gradient-success);">
                    <i class="fas fa-bolt"></i>
                </div>
                <div class="stat-info">
                    <h3 id="totalXP">0</h3>
                    <p>Total XP</p>
                    <div class="stat-change" id="xpChangeContainer">
                        <i class="fas fa-arrow-up"></i>
                        <span class="stat-change-value" id="xpChange">+0</span>
                        <span id="xpPeriod">this month</span>
                    </div>
                </div>
            </div>
            <div class="card stat-card">
                <div class="stat-icon" style="background: var(--gradient-warning);">
                    <i class="fas fa-fire"></i>
                </div>
                <div class="stat-info">
                    <h3 id="activeStreak">0</h3>
                    <p>Active Streak</p>
                    <div class="stat-change" id="streakChangeContainer">
                        <i class="fas fa-arrow-up"></i>
                        <span class="stat-change-value" id="streakChange">+0</span>
                        <span id="streakPeriod">this month</span>
                    </div>
                </div>
            </div>
            <div class="card stat-card">
                <div class="stat-icon" style="background: var(--gradient-info);">
                    <i class="fas fa-trophy"></i>
                </div>
                <div class="stat-info">
                    <h3 id="achievementsCount">0/25</h3>
                    <p>Achievements Unlocked</p>
                    <div class="stat-change positive">
                        <i class="fas fa-star"></i>
                        <span>3 new</span> this week
                    </div>
                </div>
            </div>
        </div>

        <!-- Tabs -->
        <div class="tabs" id="mainTabs">
            <button class="tab-btn active" data-tab="charts">Charts</button>
            <button class="tab-btn" data-tab="analytics">Advanced Analytics</button>
            <button class="tab-btn" data-tab="heatmap">Activity Heatmap</button>
            <button class="tab-btn" data-tab="progress">Progression</button>
            <button class="tab-btn" data-tab="predictions">Predictions</button>
        </div>

        <!-- Charts Tab -->
        <div class="tab-content active" id="chartsTab">
            <div class="charts-grid">
                <!-- Followers Chart -->
                <div class="card">
                    <div class="card-header">
                        <div>
                            <h2 class="card-title">Followers Growth</h2>
                            <p class="card-subtitle">Daily followers count with trend analysis</p>
                        </div>
                        <div class="chart-controls">
                            <button class="chart-type-btn active" data-chart="followers" data-type="line">Line</button>
                            <button class="chart-type-btn" data-chart="followers" data-type="bar">Bar</button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="followersChart"></canvas>
                    </div>
                </div>

                <!-- XP Chart -->
                <div class="card">
                    <div class="card-header">
                        <div>
                            <h2 class="card-title">XP Progression</h2>
                            <p class="card-subtitle">Daily XP with cumulative total</p>
                        </div>
                        <div class="chart-controls">
                            <button class="chart-type-btn active" data-chart="xp" data-type="line">Line</button>
                            <button class="chart-type-btn" data-chart="xp" data-type="bar">Bar</button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="xpChart"></canvas>
                    </div>
                </div>

                <!-- Streak Chart -->
                <div class="card">
                    <div class="card-header">
                        <div>
                            <h2 class="card-title">Streak History</h2>
                            <p class="card-subtitle">Daily streak counter visualization</p>
                        </div>
                        <div class="chart-controls">
                            <button class="chart-type-btn active" data-chart="streak" data-type="line">Trend</button>
                            <button class="chart-type-btn" data-chart="streak" data-type="bar">Daily</button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="streakChart"></canvas>
                    </div>
                </div>

                <!-- Comparative Chart -->
                <div class="card">
                    <div class="card-header">
                        <div>
                            <h2 class="card-title">Followers vs XP Correlation</h2>
                            <p class="card-subtitle">Relationship between followers growth and XP gain</p>
                        </div>
                        <div class="chart-controls">
                            <button class="chart-type-btn active" data-chart="comparative" data-type="line">Dual Axis</button>
                            <button class="chart-type-btn" data-chart="comparative" data-type="bar">Stacked</button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="comparativeChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Streak Display -->
            <div class="streak-container">
                <div class="card streak-card">
                    <div class="streak-count" id="currentStreakDisplay">0</div>
                    <div class="streak-label">Current Streak <i class="fas fa-fire streak-fire"></i></div>
                </div>
                <div class="card streak-card">
                    <div class="streak-count" id="longestStreakDisplay">0</div>
                    <div class="streak-label">Longest Streak <i class="fas fa-crown"></i></div>
                </div>
                <div class="card streak-card">
                    <div class="streak-count" id="totalActiveDays">0</div>
                    <div class="streak-label">Total Active Days <i class="fas fa-calendar-check"></i></div>
                </div>
                <div class="card streak-card">
                    <div class="streak-count" id="consistencyScore">0%</div>
                    <div class="streak-label">Consistency Score <i class="fas fa-chart-line"></i></div>
                </div>
            </div>
        </div>

        <!-- Advanced Analytics Tab -->
        <div class="tab-content" id="analyticsTab">
            <div class="analytics-grid">
                <div class="card analytics-card">
                    <div class="progress-ring">
                        <svg width="120" height="120" viewBox="0 0 120 120">
                            <circle class="progress-ring-bg" cx="60" cy="60" r="45"></circle>
                            <circle class="progress-ring-fill" cx="60" cy="60" r="45" id="dailyConsistencyRing"></circle>
                        </svg>
                        <div class="progress-ring-text" id="dailyConsistencyText">0%</div>
                    </div>
                    <h3 class="analytics-label">Daily Consistency</h3>
                    <p class="analytics-desc">Percentage of days with activity vs total days tracked</p>
                </div>

                <div class="card analytics-card">
                    <div class="progress-ring">
                        <svg width="120" height="120" viewBox="0 0 120 120">
                            <circle class="progress-ring-bg" cx="60" cy="60" r="45"></circle>
                            <circle class="progress-ring-fill" cx="60" cy="60" r="45" id="growthRateRing"></circle>
                        </svg>
                        <div class="progress-ring-text" id="growthRateText">0%</div>
                    </div>
                    <h3 class="analytics-label">Avg. Growth Rate</h3>
                    <p class="analytics-desc">Average daily follower growth rate over selected period</p>
                </div>

                <div class="card analytics-card">
                    <div class="progress-ring">
                        <svg width="120" height="120" viewBox="0 0 120 120">
                            <circle class="progress-ring-bg" cx="60" cy="60" r="45"></circle>
                            <circle class="progress-ring-fill" cx="60" cy="60" r="45" id="xpEfficiencyRing"></circle>
                        </svg>
                        <div class="progress-ring-text" id="xpEfficiencyText">0%</div>
                    </div>
                    <h3 class="analytics-label">XP Efficiency</h3>
                    <p class="analytics-desc">XP gained per follower over the selected period</p>
                </div>

                <div class="card analytics-card">
                    <h3 class="analytics-value" id="streakFreezeCount">0</h3>
                    <h3 class="analytics-label">Streak Freezes Used</h3>
                    <p class="analytics-desc">Days with 0 XP that didn't break your streak</p>
                    <div class="progress-bar" style="margin-top: 20px;">
                        <div class="progress-fill" id="streakFreezeBar"></div>
                    </div>
                    <small id="streakFreezePercentage">0% of total days</small>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Performance Insights</h2>
                    <p class="card-subtitle">AI-generated insights based on your activity patterns</p>
                </div>
                <div class="analytics-insights" id="analyticsInsights">
                    <!-- Insights will be generated here -->
                </div>
            </div>

            <!-- Month-over-Month Analysis -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Month-over-Month Analysis (Last 12 Months)</h2>
                    <p class="card-subtitle">Detailed comparison of monthly performance metrics</p>
                </div>
                <div class="table-container">
                    <table class="data-table" id="monthlyAnalysisTable">
                        <thead>
                            <tr>
                                <th>Month</th>
                                <th>Avg Daily XP</th>
                                <th>Total Followers Gain</th>
                                <th>Active Days</th>
                                <th>Max Streak</th>
                                <th>Growth Trend</th>
                                <th>Change vs Prev Month</th>
                            </tr>
                        </thead>
                        <tbody id="monthlyAnalysisBody">
                            <!-- Monthly data will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Heatmap Tab -->
        <div class="tab-content" id="heatmapTab">
            <div class="card">
                <div class="card-header">
                    <div>
                        <h2 class="card-title">Activity Heatmap</h2>
                        <p class="card-subtitle">Monthly activity visualization with intensity levels</p>
                    </div>
                    <div class="heatmap-controls">
                        <div class="chart-controls">
                            <button class="chart-type-btn active" data-heatmap-type="xp">XP Activity</button>
                            <button class="chart-type-btn" data-heatmap-type="followers">Followers Growth</button>
                            <button class="chart-type-btn" data-heatmap-type="combined">Combined Score</button>
                        </div>
                    </div>
                </div>
                
                <!-- Month Filter -->
                <div class="month-filter" id="monthFilter">
                    <!-- Month buttons will be generated here -->
                </div>
                
                <!-- Heatmap Display -->
                <div id="heatmapDisplay">
                    <!-- Heatmap will be generated here -->
                </div>
                
                <div class="heatmap-legend" id="heatmapLegend">
                    <!-- Legend will be generated based on heatmap type -->
                </div>
            </div>
        </div>

        <!-- Progression Tab -->
        <div class="tab-content" id="progressTab">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Progression Path</h2>
                    <p class="card-subtitle">Your journey through XP and followers milestones</p>
                </div>
                <div class="progression-path" id="progressionPath">
                    <!-- Progression milestones will be generated here -->
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Acceleration Analysis</h2>
                    <p class="card-subtitle">Growth acceleration/deceleration trends</p>
                </div>
                <div class="acceleration-analysis" id="accelerationAnalysis">
                    <!-- Acceleration analysis will be generated here -->
                </div>
            </div>
        </div>

        <!-- Predictions Tab -->
        <div class="tab-content" id="predictionsTab">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Predictive Analytics</h2>
                    <p class="card-subtitle">30-day average based forecasts</p>
                    <div class="chart-controls">
                        <button class="chart-type-btn active" data-prediction-type="30">30 Days</button>
                        <button class="chart-type-btn" data-prediction-type="90">90 Days</button>
                        <button class="chart-type-btn" data-prediction-type="180">180 Days</button>
                        <button class="chart-type-btn" data-prediction-type="365">1 Year</button>
                     
<button class="chart-type-btn" data-prediction-type="730">2 Years</button>
<button class="chart-type-btn" data-prediction-type="1825">5 Years</button>


                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="predictionChart"></canvas>
                </div>
            </div>

            <div class="prediction-cards">
                <div class="card prediction-card">
                    <div class="prediction-title">Next 30 Days Prediction</div>
                    <div class="prediction-value" id="prediction30Days">0</div>
                    <div class="prediction-metric">
                        Estimated followers gain: <span id="predictionFollowers30">0</span><br>
                        Estimated XP gain: <span id="predictionXP30">0</span>
                    </div>
                </div>
                
                <div class="card prediction-card">
                    <div class="prediction-title">Next 90 Days Prediction</div>
                    <div class="prediction-value" id="prediction90Days">0</div>
                    <div class="prediction-metric">
                        Estimated followers gain: <span id="predictionFollowers90">0</span><br>
                        Estimated XP gain: <span id="predictionXP90">0</span>
                    </div>
                </div>
                
                <div class="card prediction-card">
                    <div class="prediction-title">Yearly Prediction</div>
                    <div class="prediction-value" id="prediction365Days">0</div>
                    <div class="prediction-metric">
                        Estimated followers gain: <span id="predictionFollowers365">0</span><br>
                        Estimated XP gain: <span id="predictionXP365">0</span>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Milestone Predictions</h2>
                    <p class="card-subtitle">Estimated dates for reaching major milestones based on 30-day averages</p>
                </div>
                <div class="predictive-analytics" id="predictiveAnalytics">
                    <!-- Predictive analytics will be generated here -->
                </div>
            </div>
        </div>

        <!-- Achievements -->
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">Achievements & Milestones</h2>
                <p class="card-subtitle">Unlock achievements by reaching XP and followers milestones</p>
                <div class="chart-controls">
                    <button class="chart-type-btn active" data-achievement-type="xp">XP Achievements</button>
                    <button class="chart-type-btn" data-achievement-type="followers">Followers Achievements</button>
                    <button class="chart-type-btn" data-achievement-type="streak">Streak Achievements</button>
                </div>
            </div>
            <div class="achievements-grid" id="achievementsContainer">
                <!-- Achievements will be dynamically inserted here -->
            </div>
        </div>

        <!-- Data Table -->
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">Detailed Data Table</h2>
                <p class="card-subtitle">Complete dataset with filtering and sorting</p>
                <div class="table-search">
                    <input type="text" id="tableSearch" placeholder="Search data..." style="width: 250px;">
                    <i class="fas fa-search"></i>
                </div>
            </div>
            <div class="table-container">
                <table class="data-table" id="dataTable">
                    <thead>
                        <tr>
                            <th data-sort="date">Date <i class="fas fa-sort"></i></th>
                            <th data-sort="followers">Followers <i class="fas fa-sort"></i></th>
                            <th data-sort="followersChange">Daily Change <i class="fas fa-sort"></i></th>
                            <th data-sort="xp">XP <i class="fas fa-sort"></i></th>
                            <th data-sort="xpLevel">XP Level <i class="fas fa-sort"></i></th>
                            <th data-sort="streakDay">Streak Day <i class="fas fa-sort"></i></th>
                            <th data-sort="status">Status <i class="fas fa-sort"></i></th>
                            <th data-sort="activityScore">Activity Score <i class="fas fa-sort"></i></th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <!-- Table data will be dynamically inserted here -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <p>Advanced Analytics Dashboard v3.0 • Real-time intelligence • AI-powered predictions</p>
            <p>Last updated: <span id="currentDate"></span> | <span id="dataCount">0</span> days of data tracked</p>
        </footer>
    </div>

    <!-- Modals -->
    <div class="modal" id="exportModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Export Data</h3>
                <button class="modal-close" id="closeExportModal">&times;</button>
            </div>
            <div class="modal-body">
                <p>Select export format:</p>
                <div style="display: flex; gap: 10px; margin: 20px 0;">
                    <button class="chart-type-btn" id="exportCSV">CSV</button>
                    <button class="chart-type-btn" id="exportJSON">JSON</button>
                    <button class="chart-type-btn" id="exportExcel">Excel</button>
                </div>
                <p>Date range:</p>
                <div class="date-range-selector" style="margin: 20px 0;">
                    <button class="date-range-btn active" data-range="weekly">Weekly</button>
                    <button class="date-range-btn" data-range="monthly">Monthly</button>
                    <button class="date-range-btn" data-range="yearly">Yearly</button>
                    <button class="date-range-btn" data-range="lifetime">Lifetime</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Dashboard Settings</h3>
                <button class="modal-close" id="closeSettingsModal">&times;</button>
            </div>
            <div class="modal-body">
                <div style="margin-bottom: 20px;">
                    <h4 style="margin-bottom: 10px;">Chart Settings</h4>
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <label>
                            <input type="checkbox" id="smoothLines" checked> Smooth chart lines
                        </label>
                        <label>
                            <input type="checkbox" id="showGrid" checked> Show chart grid
                        </label>
                        <label>
                            <input type="checkbox" id="animations" checked> Enable animations
                        </label>
                    </div>
                </div>
                <div style="margin-bottom: 20px;">
                    <h4 style="margin-bottom: 10px;">Data Refresh</h4>
                    <select id="refreshInterval" class="chart-type-btn" style="width: 100%;">
                        <option value="manual">Manual</option>
                        <option value="5">Every 5 minutes</option>
                        <option value="15">Every 15 minutes</option>
                        <option value="30">Every 30 minutes</option>
                        <option value="60">Every hour</option>
                    </select>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Raw data (same as provided)
        const rawData = [          
        { date: "2024-01-24", followers: 1, xp: 4050 },
{ date: "2024-01-25", followers: 1, xp: 7000 },
{ date: "2024-01-26", followers: 8, xp: 4500 },

{ date: "2024-01-27", followers: 17, xp: 6000 },
{ date: "2024-01-28", followers: 31, xp: 5000 },
{ date: "2024-01-29", followers: 56, xp: 2370 },
{ date: "2024-01-30", followers: 62, xp: 9800 },
{ date: "2024-01-31", followers: 73, xp: 3450 },
{ date: "2024-02-01", followers: 87, xp: 4590 },
{ date: "2024-02-02", followers: 101, xp: 1890 },
{ date: "2024-02-03", followers: 109, xp: 3400 },
{ date: "2024-02-04", followers: 114, xp: 9000 },
{ date: "2024-02-05", followers: 131, xp: 7000 },
{ date: "2024-02-06", followers: 138, xp: 1000 },
{ date: "2024-02-07", followers: 149, xp: 5000 },
{ date: "2024-02-08", followers: 167, xp: 4000 },
{ date: "2024-02-09", followers: 175, xp: 2600 },
{ date: "2024-02-10", followers: 182, xp: 6000 },
{ date: "2024-02-11", followers: 188, xp: 4500 },
{ date: "2024-02-12", followers: 189, xp: 7900 },
{ date: "2024-02-13", followers: 191, xp: 8900 },
{ date: "2024-02-14", followers: 201, xp: 20 },
{ date: "2024-02-15", followers: 204, xp: 3500 },
{ date: "2024-02-16", followers: 208, xp: 7900 },
{ date: "2024-02-17", followers: 218, xp: 8000 },
{ date: "2024-02-18", followers: 223, xp: 10000 },
{ date: "2024-02-19", followers: 231, xp: 5000 },
{ date: "2024-02-20", followers: 239, xp: 5900 },
{ date: "2024-02-21", followers: 246, xp: 8000},
{ date: "2024-02-22", followers: 251, xp: 9000},
{ date: "2024-02-23", followers: 259, xp: 6000 },
{ date: "2024-02-24", followers: 272, xp: 2030 },
{ date: "2024-02-25", followers: 289, xp: 3900 },
{ date: "2024-02-26", followers: 298, xp: 2400 },
{ date: "2024-02-27", followers: 321, xp: 7500 },
{ date: "2024-02-28", followers: 326, xp: 1100 },
{ date: "2024-02-29", followers: 333, xp: 2000 },
{ date: "2024-03-01", followers: 337, xp: 4000 },
{ date: "2024-03-02", followers: 339, xp: 6000 },
{ date: "2024-03-03", followers: 343, xp: 20 },
{ date: "2024-03-04", followers: 344, xp: 8000 },
{ date: "2024-03-05", followers: 345, xp: 1900 },
{ date: "2024-03-06", followers: 347, xp: 8700 },
{ date: "2024-03-07", followers: 348, xp:2100 },
{ date: "2024-03-08", followers: 348, xp:9000 },
{ date: "2024-03-09", followers: 350, xp: 1000 },
{ date: "2024-03-10", followers: 352, xp: 4084 },
{ date: "2024-03-11", followers:353, xp: 4290 },
{ date: "2024-03-12", followers: 353, xp: 7296 },
{ date: "2024-03-13", followers: 352, xp: 3302 },
{ date: "2024-03-14", followers: 354, xp: 308 },
{ date: "2024-03-15", followers: 355, xp: 5314 },
{ date: "2024-03-16", followers: 355, xp: 321 },
{ date: "2024-03-17", followers: 357, xp: 342 },
{ date: "2024-03-18", followers:358, xp: 340 },
{ date: "2024-03-19", followers: 360, xp: 5330 },
{ date: "2024-03-20", followers: 362, xp: 4445 },
{ date: "2024-03-21", followers: 368, xp: 5350 },
{ date: "2024-03-22", followers: 371, xp: 2350 },
{ date: "2024-03-23", followers: 374, xp: 6360 },
{ date: "2024-03-24", followers: 374, xp: 370 },
{ date: "2024-03-25", followers: 377, xp: 30 },
{ date: "2024-03-26", followers: 381, xp: 3000 },
{ date: "2024-03-27", followers: 384, xp: 1000 },
{ date: "2024-03-28", followers: 388, xp: 2000 },
{ date: "2024-03-29", followers: 391, xp: 1000 },
{ date: "2024-03-30", followers: 391, xp: 4000 },
{ date: "2024-03-31", followers: 392, xp: 2000 },
{ date: "2024-04-01", followers: 392, xp: 7000 },
{ date: "2024-04-02", followers: 393, xp: 6000 },
{ date: "2024-04-03", followers: 394, xp: 800 },
{ date: "2024-04-04", followers: 395, xp: 7000 },
{ date: "2024-04-05", followers: 395, xp: 2000 },
{ date: "2024-04-06", followers: 396, xp: 3000 },
{ date: "2024-04-07", followers: 397, xp: 7000 },
{ date: "2024-04-08", followers: 399, xp: 6000 },
{ date: "2024-04-09", followers: 400, xp: 3000 },
{ date: "2024-04-10", followers: 401, xp: 7000 },
{ date: "2024-04-11", followers: 402, xp: 3000 },
{ date: "2024-04-12", followers: 402, xp: 2000 },
{ date: "2024-04-13", followers: 402, xp: 8000 },
{ date: "2024-04-14", followers: 403, xp: 7000 },
{ date: "2024-04-15", followers: 403, xp: 900 },
{ date: "2024-04-16", followers: 402, xp: 4000 },
{ date: "2024-04-17", followers: 403, xp: 4000 },
{ date: "2024-04-18", followers: 402, xp: 5500 },
{ date: "2024-04-19", followers: 405, xp: 5030 },
{ date: "2024-04-20", followers: 407, xp: 3536 },
{ date: "2024-04-21", followers: 410, xp: 4542 },
{ date: "2024-04-22", followers: 411, xp: 8548 },
{ date: "2024-04-23", followers: 420, xp: 6554 },
{ date: "2024-04-24", followers: 426, xp: 4560 },
{ date: "2024-04-25", followers: 429, xp: 5566 },
{ date: "2024-04-26", followers: 431, xp: 8573 },
{ date: "2024-04-27", followers: 436, xp: 2579 },
{ date: "2024-04-28", followers: 438, xp: 4585 },
{ date: "2024-04-29", followers: 441, xp: 7591 },
{ date: "2024-04-30", followers: 445, xp: 507 },
{ date: "2024-05-01", followers: 449, xp: 2603 },
{ date: "2024-05-02", followers: 451, xp: 5609 },
{ date: "2024-05-03", followers: 455, xp: 7616 },
{ date: "2024-05-04", followers: 459, xp: 3622 },
{ date: "2024-05-05", followers: 463, xp: 8628 },
{ date: "2024-05-06", followers: 466, xp: 6634 },
{ date: "2024-05-07", followers: 468, xp: 7640 },
{ date: "2024-05-08", followers: 473, xp: 60 },
{ date: "2024-05-09", followers: 477, xp: 20 },
{ date: "2024-05-10", followers: 481, xp: 90 },
{ date: "2024-05-11", followers: 484, xp: 15 },
{ date: "2024-05-12", followers: 485, xp: 20 },
{ date: "2024-05-13", followers: 496, xp: 10 },
{ date: "2024-05-14", followers: 497, xp: 80 },
{ date: "2024-05-15", followers: 497, xp: 30 },
{ date: "2024-05-16", followers: 498, xp: 40 },
{ date: "2024-05-17", followers: 499, xp: 20 },
{ date: "2024-05-18", followers: 501, xp: 10 },
{ date: "2024-05-19", followers: 501, xp:500  },
{ date: "2024-05-20", followers: 502, xp: 10 },
{ date: "2024-05-21", followers: 503, xp: 10 },
{ date: "2024-05-22", followers: 503, xp: 10 },
{ date: "2024-05-23", followers: 503, xp: 20 },
{ date: "2024-05-24", followers: 504, xp:10  },
{ date: "2024-05-25", followers: 504, xp:20  },
{ date: "2024-05-26", followers: 504, xp: 10 },
{ date: "2024-05-27", followers: 504, xp:10  },
{ date: "2024-05-28", followers: 504, xp:10  },
{ date: "2024-05-29", followers: 506, xp: 20 },
{ date: "2024-05-30", followers: 505, xp: 20 },
{ date: "2024-05-31", followers: 505, xp: 10 },
{ date: "2024-06-01", followers: 506, xp: 10 },
{ date: "2024-06-02", followers: 506, xp: 10 },
{ date: "2024-06-03", followers: 506, xp: 20 },

{ date: "2024-06-04", followers: 507, xp: 20 },
{ date: "2024-06-05", followers: 507, xp: 10 },
{ date: "2024-06-06", followers: 507, xp: 10 },
{ date: "2024-06-07", followers: 507, xp: 20 },
{ date: "2024-06-08", followers: 507, xp: 10 },
{ date: "2024-06-09", followers: 507, xp: 20 },
{ date: "2024-06-10", followers: 507, xp: 20 },
{ date: "2024-06-11", followers: 507, xp:10  },
{ date: "2024-06-12", followers: 506, xp:10  },
{ date: "2024-06-13", followers: 506, xp:20  },
{ date: "2024-06-14", followers: 507, xp:10  },
{ date: "2024-06-15", followers: 507, xp:10  },
{ date: "2024-06-16", followers: 507, xp: 20 },
{ date: "2024-06-17", followers: 508, xp: 20 },
{ date: "2024-06-18", followers: 508, xp: 10 },
{ date: "2024-06-19", followers: 508, xp: 10 },
{ date: "2024-06-20", followers: 508, xp: 20 },
{ date: "2024-06-21", followers: 509, xp: 20 },
{ date: "2024-06-22", followers: 508, xp: 20 },
{ date: "2024-06-23", followers: 509, xp:200},
{ date: "2024-06-24", followers: 509, xp:10 },
{ date: "2024-06-25", followers: 508, xp: 20},
{ date: "2024-06-26", followers: 508, xp: 10},
{ date: "2024-06-27", followers: 508, xp:10 },
{ date: "2024-06-28", followers: 508, xp: 20},
{ date: "2024-06-29", followers: 507, xp: 10},
{ date: "2024-06-30", followers: 507, xp: 10},
{ date: "2024-07-01", followers: 507, xp: 10},
{ date: "2024-07-02", followers: 506, xp: 20},
{ date: "2024-07-03", followers: 507, xp: 10},
{ date: "2024-07-04", followers: 507, xp: 20},
{ date: "2024-07-05", followers: 507, xp: 10 },
{ date: "2024-07-06", followers: 507, xp: 20 },
{ date: "2024-07-07", followers: 507, xp: 10 },
{ date: "2024-07-08", followers: 508, xp: 10 },
{ date: "2024-07-09", followers: 508, xp: 10 },
{ date: "2024-07-10", followers: 509, xp: 10 },
{ date: "2024-07-11", followers: 510, xp: 10 },
{ date: "2024-07-12", followers: 510, xp: 10 },
{ date: "2024-07-13", followers: 511, xp: 10 },
{ date: "2024-07-14", followers: 512, xp: 10 },
{ date: "2024-07-15", followers: 512, xp: 10 },
{ date: "2024-07-16", followers: 513, xp: 10 },
{ date: "2024-07-17", followers: 513, xp: 10 },
{ date: "2024-07-18", followers: 513, xp: 10 },
{ date: "2024-07-19", followers: 514, xp: 10 },
{ date: "2024-07-20", followers: 515, xp: 10 },
{ date: "2024-07-21", followers: 515, xp:10  },
{ date: "2024-07-22", followers: 515, xp: 20 },
{ date: "2024-07-23", followers: 517, xp: 20 },
{ date: "2024-07-24", followers: 518, xp: 10 },
{ date: "2024-07-25", followers: 519, xp:  20},
{ date: "2024-07-26", followers: 520, xp: 10 },
{ date: "2024-07-27", followers: 521, xp: 20 },
{ date: "2024-07-28", followers: 522, xp: 20 },
{ date: "2024-07-29", followers: 524, xp: 10 },
{ date: "2024-07-30", followers: 525, xp: 10 },
{ date: "2024-07-31", followers: 525, xp: 10 },
{ date: "2024-08-01", followers: 526, xp: 20 },
{ date: "2024-08-02", followers: 527, xp: 10 },
{ date: "2024-08-03", followers: 530, xp: 10 },
{ date: "2024-08-04", followers: 531, xp: 10 },
{ date: "2024-08-05", followers: 531, xp: 10 },
{ date: "2024-08-06", followers:531 , xp: 20 },
{ date: "2024-08-07", followers:532 , xp: 20 },
{ date: "2024-08-08", followers:533 , xp: 10 },
{ date: "2024-08-09", followers:533 , xp:20  },
{ date: "2024-08-10", followers:532 , xp: 10 },
{ date: "2024-08-11", followers: 532, xp: 20 },
{ date: "2024-08-12", followers:533 , xp:10  },
{ date: "2024-08-13", followers: 533, xp: 10 },
{ date: "2024-08-14", followers:533 , xp: 20 },
{ date: "2024-08-15", followers: 533, xp: 10 },
{ date: "2024-08-16", followers: 533, xp: 10 },
{ date: "2024-08-17", followers: 533, xp: 20 },
{ date: "2024-08-18", followers: 534, xp:  20},
{ date: "2024-08-19", followers:534 , xp: 10 },
{ date: "2024-08-20", followers:534 , xp:20  },
{ date: "2024-08-21", followers: 534, xp: 20 },
{ date: "2024-08-22", followers:535 , xp: 10 },
{ date: "2024-08-23", followers: 535, xp: 20 },
{ date: "2024-08-24", followers: 535, xp: 10 },
{ date: "2024-08-25", followers: 535, xp: 10 },
{ date: "2024-08-26", followers: 535, xp: 10 },
{ date: "2024-08-27", followers: 534, xp: 10 },
{ date: "2024-08-28", followers:534 , xp: 40 },
{ date: "2024-08-29", followers:534 , xp: 40 },
{ date: "2024-08-30", followers:533 , xp: 20 },
{ date: "2024-08-31", followers:533 , xp: 10 },
{ date: "2024-09-01", followers:534 , xp:10  },
{ date: "2024-09-02", followers: 534, xp: 10 },
{ date: "2024-09-03", followers: 534, xp:  20},
{ date: "2024-09-04", followers: 535, xp:20  },
{ date: "2024-09-05", followers:535 , xp: 20 },
{ date: "2024-09-06", followers: 536, xp: 10 },
{ date: "2024-09-07", followers:537 , xp: 10 },
{ date: "2024-09-08", followers:537 , xp: 10 },
{ date: "2024-09-09", followers:538 , xp: 40 },
{ date: "2024-09-10", followers: 538, xp: 20 },
{ date: "2024-09-11", followers:539 , xp: 10 },
{ date: "2024-09-12", followers:539 , xp: 10 },
{ date: "2024-09-13", followers:539 , xp:20  },
{ date: "2024-09-14", followers:539 , xp: 20 },
{ date: "2024-09-15", followers:539 , xp:10  },
{ date: "2024-09-16", followers:539 , xp: 20 },
{ date: "2024-09-17", followers: 540, xp:10  },
{ date: "2024-09-18", followers: 541, xp: 20 },
{ date: "2024-09-19", followers: 541, xp:10  },
{ date: "2024-09-20", followers: 542, xp:20  },
{ date: "2024-09-21", followers: 542, xp:10  },
{ date: "2024-09-22", followers: 543, xp: 20 },
{ date: "2024-09-23", followers: 543, xp: 20 },
{ date: "2024-09-24", followers: 543, xp:20  },
{ date: "2024-09-25", followers: 543, xp: 20 },
{ date: "2024-09-26", followers: 543, xp: 10 },
{ date: "2024-09-27", followers:542 , xp: 10 },
{ date: "2024-09-28", followers: 542, xp: 10 },
{ date: "2024-09-29", followers: 542, xp:  10},
{ date: "2024-09-30", followers: 542, xp:20  },
{ date: "2024-10-01", followers: 544, xp: 1540 },
{ date: "2024-10-02", followers: 555, xp: 13500 },
{ date: "2024-10-03", followers: 576, xp: 5200 },
{ date: "2024-10-04", followers: 587, xp: 11000 },
{ date: "2024-10-05", followers: 601, xp: 15200 },
{ date: "2024-10-06", followers: 612, xp: 500 },
{ date: "2024-10-07", followers: 623, xp: 7900 },
{ date: "2024-10-08", followers: 637, xp: 5200 },
{ date: "2024-10-09", followers: 649, xp: 13500 },
{ date: "2024-10-10", followers: 666, xp: 1000 },
{ date: "2024-10-11", followers: 671, xp: 7900 },
{ date: "2024-10-12", followers: 678, xp: 4000 },
{ date: "2024-10-13", followers:681 , xp: 1000 },
{ date: "2024-10-14", followers: 687, xp: 15200 },
{ date: "2024-10-15", followers: 692, xp: 20 },
{ date: "2024-10-16", followers: 698, xp: 4000 },
{ date: "2024-10-17", followers:699 , xp: 11000 },
{ date: "2024-10-18", followers: 706, xp: 4000 },
{ date: "2024-10-19", followers: 710, xp: 2000 },
{ date: "2024-10-20", followers: 713, xp: 5200 },
{ date: "2024-10-21", followers:718 , xp: 13500 },
{ date: "2024-10-22", followers:722 , xp: 7900 },
{ date: "2024-10-23", followers: 725, xp: 2000 },
{ date: "2024-10-24", followers: 731, xp: 2000 },
{ date: "2024-10-25", followers: 739, xp: 40 },
{ date: "2024-10-26", followers:741 , xp: 5200 },
{ date: "2024-10-27", followers: 744, xp: 13500 },
{ date: "2024-10-28", followers:745 , xp: 1000 },
{ date: "2024-10-29", followers:747 , xp: 7900 },
{ date: "2024-10-30", followers:749 , xp: 11000 },
{ date: "2024-10-31", followers:753 , xp: 5200 },
{ date: "2024-11-01", followers: 755, xp: 15200 },
{ date: "2024-11-02", followers:759 , xp: 200 },
{ date: "2024-11-03", followers:764 , xp: 3600 },
{ date: "2024-11-04", followers: 769, xp: 1000 },
{ date: "2024-11-05", followers: 773, xp: 15000 },
{ date: "2024-11-06", followers:778 , xp: 25000 },
{ date: "2024-11-07", followers: 779, xp: 23600 },
{ date: "2024-11-08", followers: 783, xp: 41000 },
{ date: "2024-11-09", followers:788 , xp:24010 },
{ date: "2024-11-10", followers: 792, xp: 11000 },
{ date: "2024-11-11", followers: 802, xp: 15200 },
{ date: "2024-11-12", followers: 807, xp: 2000 },
{ date: "2024-11-13", followers:809 , xp: 7900 },
{ date: "2024-11-14", followers: 817, xp: 5200 },
{ date: "2024-11-15", followers: 821, xp: 1000 },
{ date: "2024-11-16", followers: 825, xp: 3600 },
{ date: "2024-11-17", followers: 827, xp: 13500 },
{ date: "2024-11-17", followers: 829, xp: 500 },
{ date: "2024-11-19", followers: 833, xp: 13500 },
{ date: "2024-11-20", followers:837 , xp: 400 },
{ date: "2024-11-21", followers: 839, xp: 3600 },
{ date: "2024-11-22", followers: 841, xp: 11000 },
{ date: "2024-11-23", followers: 843, xp: 15200 },
{ date: "2024-11-24", followers: 846, xp: 2000 },
{ date: "2024-11-25", followers: 847, xp: 2000 },
{ date: "2024-11-26", followers: 848, xp: 300 },
{ date: "2024-11-27", followers: 850, xp: 100 },
{ date: "2024-11-28", followers:852 , xp: 15200 },
{ date: "2024-11-29", followers:854 , xp: 3600 },
{ date: "2024-11-30", followers: 856, xp: 3600 },
{ date: "2024-12-01", followers: 857, xp: 0 },
{ date: "2024-12-02", followers:858 , xp: 4000 },
{ date: "2024-12-03", followers:859 , xp: 4000 },
{ date: "2024-12-04", followers:860 , xp: 15100 },
{ date: "2024-12-05", followers:860 , xp: 2000 },
{ date: "2024-12-06", followers: 860, xp: 1000 },
{ date: "2024-12-07", followers:861 , xp: 7900 },
{ date: "2024-12-08", followers: 861, xp: 5200 },
{ date: "2024-12-09", followers:863 , xp: 13500 },
{ date: "2024-12-10", followers:865 , xp: 15200 },
{ date: "2024-12-11", followers: 869, xp: 1000 },
{ date: "2024-12-12", followers:873 , xp: 11000 },
{ date: "2024-12-13", followers:876 , xp: 13500 },
{ date: "2024-12-14", followers: 879, xp: 13500 },
{ date: "2024-12-15", followers: 884, xp: 3600 },
{ date: "2024-12-16", followers: 886, xp: 2000 },
{ date: "2024-12-17", followers: 888, xp: 4000 },
{ date: "2024-12-18", followers: 891, xp: 5200 },
{ date: "2024-12-19", followers: 894, xp: 3600 },
{ date: "2024-12-20", followers: 897, xp: 3600 },
{ date: "2024-12-21", followers: 899, xp: 2000 },
{ date: "2024-12-22", followers: 901, xp: 2000 },
{ date: "2024-12-23", followers: 911, xp: 2000 },
{ date: "2024-12-24", followers: 918, xp: 3600 },
{ date: "2024-12-25", followers:922 , xp: 0 },
{ date: "2024-12-26", followers:929 , xp: 2000 },
{ date: "2024-12-27", followers:936 , xp: 2000 },
{ date: "2024-12-28", followers:943 , xp: 4000 },
{ date: "2024-12-29", followers: 950, xp: 900 },
{ date: "2024-12-30", followers: 956, xp: 5200 },
{ date: "2024-12-31", followers: 962, xp: 2000 },
{ date: "2025-01-01", followers: 969, xp: 2000 },
{ date: "2025-01-02", followers: 972, xp: 2000 },
{ date: "2025-01-03", followers:977 , xp: 3600},
{ date: "2025-01-04", followers:979 , xp: 5200},
{ date: "2025-01-05", followers: 982, xp: 3600},
{ date: "2025-01-06", followers:987 , xp: 2000},
{ date: "2025-01-07", followers:992 , xp: 3600},
{ date: "2025-01-08", followers:996 , xp: 4000},
{ date: "2025-01-09", followers:996 , xp: 7900},
{ date: "2025-01-10", followers: 1000, xp: 2000 },
{ date: "2025-01-11", followers: 1012, xp: 1200 },
{ date: "2025-01-12", followers: 1023, xp: 2000 },
{ date: "2025-01-13", followers: 1031, xp:  12000},
{ date: "2025-01-14", followers: 1052, xp: 5200 },
{ date: "2025-01-15", followers: 1061, xp: 3500 },
{ date: "2025-01-16", followers:1076 , xp:1000  },
{ date: "2025-01-17", followers:1080 , xp: 1200 },
{ date: "2025-01-18", followers:1086 , xp: 11000 },
{ date: "2025-01-19", followers:1091 , xp: 1200 },
{ date: "2025-01-20", followers:1098 , xp: 4000 },
{ date: "2025-01-21", followers:1100 , xp: 3600 },
{ date: "2025-01-22", followers:1105 , xp: 5200 },
{ date: "2025-01-23", followers: 1110, xp: 3500 },
{ date: "2025-01-24", followers:1110 , xp: 7900 },
{ date: "2025-01-25", followers: 1113, xp:1000  },
{ date: "2025-01-26", followers:1115 , xp: 2000 },
{ date: "2025-01-27", followers:1119 , xp: 2000 },
{ date: "2025-01-28", followers:1121 , xp: 3600 },
{ date: "2025-01-29", followers:1123 , xp: 2000 },
{ date: "2025-01-30", followers:1126 , xp: 5200 },
{ date: "2025-01-31", followers:1129 , xp: 3600 },
{ date: "2025-02-01", followers:1133 , xp: 4000 },
{ date: "2025-02-02", followers:1136 , xp: 5200 },
{ date: "2025-02-03", followers:1139 , xp: 2000 },
{ date: "2025-02-04", followers:1141 , xp: 2000 },
{ date: "2025-02-05", followers:1145 , xp: 7900 },
{ date: "2025-02-06", followers:1146 , xp: 3600 },
{ date: "2025-02-07", followers:1152 , xp: 2000 },
{ date: "2025-02-08", followers: 1159, xp: 2000 },
{ date: "2025-02-09", followers: 1162, xp: 2000 },
{ date: "2025-02-10", followers: 1166, xp: 3600 },
{ date: "2025-02-11", followers: 1169, xp: 4000 },
{ date: "2025-02-12", followers: 1172, xp: 2000 },
{ date: "2025-02-13", followers: 1175, xp: 3200 },
{ date: "2025-02-14", followers:1179 , xp: 10 },
{ date: "2025-02-15", followers: 1184, xp: 5200 },
{ date: "2025-02-16", followers: 1191, xp: 2000 },
{ date: "2025-02-17", followers: 1198, xp: 2000 },
{ date: "2025-02-18", followers: 1200, xp: 3600 },
{ date: "2025-02-19", followers: 1207, xp: 2000 },
{ date: "2025-02-20", followers: 1211, xp: 2000 },
{ date: "2025-02-21", followers: 1215, xp: 900 },
{ date: "2025-02-22", followers: 1221, xp: 5200 },
{ date: "2025-02-23", followers: 1229, xp: 1000 },
{ date: "2025-02-24", followers: 1232, xp: 3600 },
{ date: "2025-02-25", followers: 1236, xp: 3600 },
{ date: "2025-02-26", followers: 1242, xp: 5200 },
{ date: "2025-02-27", followers: 1244, xp: 10000 },
{ date: "2025-02-28", followers:1249 , xp: 2000 },
{ date: "2025-03-01", followers:1251 , xp: 2000 },
{ date: "2025-03-02", followers:1253 , xp: 10 },
{ date: "2025-03-03", followers:1255 , xp: 2000 },
{ date: "2025-03-04", followers:1258 , xp: 7900 },
{ date: "2025-03-05", followers: 1261, xp: 5200 },
{ date: "2025-03-06", followers: 1266, xp: 5200 },
{ date: "2025-03-07", followers: 1271, xp: 3600 },
{ date: "2025-03-08", followers: 1274, xp: 3600 },
{ date: "2025-03-09", followers: 1277, xp: 2000 },
{ date: "2025-03-10", followers: 1279, xp: 4000 },
{ date: "2025-03-11", followers: 1282, xp: 2000 },
{ date: "2025-03-12", followers: 1287, xp: 2000 },
{ date: "2025-03-13", followers: 1291, xp: 2000 },
{ date: "2025-03-14", followers: 1293, xp: 12000 },
{ date: "2025-03-15", followers: 1294, xp: 7900 },
{ date: "2025-03-16", followers: 1294, xp: 5200 },
{ date: "2025-03-17", followers: 1295, xp: 2000 },
{ date: "2025-03-18", followers:1295 , xp: 2000 },
{ date: "2025-03-19", followers: 1296, xp: 2000 },
{ date: "2025-03-20", followers:1295 , xp: 3600 },
{ date: "2025-03-21", followers:1295 , xp: 12000 },
{ date: "2025-03-22", followers:1300 , xp: 24000 },
{ date: "2025-03-23", followers: 1308, xp: 2000 },
{ date: "2025-03-24", followers: 1311, xp: 4000 },
{ date: "2025-03-25", followers: 1315, xp: 3600 },
{ date: "2025-03-26", followers: 1321, xp: 5200 },
{ date: "2025-03-27", followers: 1326, xp: 7900 },
{ date: "2025-03-28", followers: 1329, xp: 2000 },
{ date: "2025-03-29", followers:1333 , xp: 2000 },
{ date: "2025-03-30", followers:1344 , xp: 12000 },
{ date: "2025-03-31", followers: 1351, xp: 16000 },
{ date: "2025-04-01", followers: 1355, xp: 18000 },
{ date: "2025-04-02", followers: 1361, xp: 19000 },
{ date: "2025-04-03", followers: 1372, xp: 14000 },
{ date: "2025-04-04", followers: 1383, xp: 22000 },
{ date: "2025-04-05", followers: 1391, xp: 29000 },
{ date: "2025-04-06", followers: 1399, xp: 12000 },
{ date: "2025-04-07", followers: 1406, xp:5000 },
{ date: "2025-04-08", followers: 1409, xp: 1000 },
{ date: "2025-04-09", followers: 1413, xp: 1000 },
{ date: "2025-04-10", followers: 1419, xp: 1100 },
{ date: "2025-04-11", followers: 1423, xp: 2000 },
{ date: "2025-04-12", followers: 1429, xp: 2000 },
{ date: "2025-04-13", followers: 1433, xp: 10 },
{ date: "2025-04-14", followers: 1443, xp: 3600 },
{ date: "2025-04-15", followers: 1449, xp: 2000 },
{ date: "2025-04-16", followers: 1456, xp: 2000 },
{ date: "2025-04-17", followers: 1465, xp: 4000 },
{ date: "2025-04-18", followers: 1468, xp: 4000 },
{ date: "2025-04-19", followers: 1472, xp: 3600 },
{ date: "2025-04-20", followers: 1476, xp: 2000 },
{ date: "2025-04-21", followers: 1480, xp: 5200 },
{ date: "2025-04-22", followers: 1485, xp: 2000 },
{ date: "2025-04-23", followers: 1489, xp: 2000 },
{ date: "2025-04-24", followers: 1492, xp: 3600 },
{ date: "2025-04-25", followers: 1503, xp: 4000 },
{ date: "2025-04-26", followers: 1509, xp: 2000 },
{ date: "2025-04-27", followers: 1517, xp: 5200 },
{ date: "2025-04-28", followers: 1528, xp: 7900 },
{ date: "2025-04-29", followers: 1545, xp: 2000 },
{ date: "2025-04-30", followers: 1559, xp: 3600 },
{ date: "2025-05-01", followers: 1574, xp: 3600 },
{ date: "2025-05-02", followers: 1591, xp: 10 },
{ date: "2025-05-03", followers: 1599, xp: 2000 },
{ date: "2025-05-04", followers: 1605, xp: 2000 },
{ date: "2025-05-05", followers: 1615, xp: 5200 },
{ date: "2025-05-06", followers: 1623, xp: 2000 },
{ date: "2025-05-07", followers: 1625, xp: 2000 },
{ date: "2025-05-08", followers: 1639, xp: 20 },
{ date: "2025-05-09", followers: 1646, xp: 2000 },
{ date: "2025-05-10", followers: 1651, xp: 7900 },
{ date: "2025-05-11", followers: 1658, xp: 4000 },
{ date: "2025-05-12", followers: 1664, xp: 2000 },
{ date: "2025-05-13", followers: 1672, xp: 5200 },
{ date: "2025-05-14", followers: 1676, xp: 1340 },
{ date: "2025-05-15", followers: 1681, xp: 6900 },
{ date: "2025-05-16", followers: 1683, xp: 13540 },
{ date: "2025-05-17", followers: 1685, xp: 7200 },
{ date: "2025-05-18", followers: 1688, xp:14700 },
{ date: "2025-05-19", followers: 1691, xp: 12000 },
{ date: "2025-05-20", followers: 1695, xp: 1000 },
{ date: "2025-05-21", followers: 1697, xp: 4000 },
{ date: "2025-05-22", followers: 1699, xp: 2975 },
{ date: "2025-05-23", followers: 1700, xp: 5000 },
{ date: "2025-05-24", followers: 1713, xp: 9000 },
{ date: "2025-05-25", followers: 1726, xp: 5000 },


//estimated above




{ date: "2025-05-26", followers: 1730, xp: 3000 },   
    { date: "2025-05-27", followers: 1746, xp: 5000 },
      { date: "2025-05-28", followers: 1765, xp: 8000 },
      { date: "2025-05-29", followers: 1785, xp: 12000 },
      { date: "2025-05-30", followers: 1798, xp: 13800 },
      { date: "2025-05-31", followers: 1808, xp: 10 },
      { date: "2025-06-01", followers: 1810, xp: 200 },
      { date: "2025-06-02", followers: 1833, xp: 600 },
      { date: "2025-06-03", followers: 1853, xp: 1600 },
      { date: "2025-06-04", followers: 1873, xp: 2300 },
      { date: "2025-06-05", followers: 1885, xp: 1200 },
      { date: "2025-06-06", followers: 1894, xp: 2000 },
      { date: "2025-06-07", followers: 1913, xp: 4000 },
      { date: "2025-06-08", followers: 1924, xp: 13500 },
      { date: "2025-06-09", followers: 1936, xp: 12700 },
      { date: "2025-06-10", followers: 1940, xp: 715 },
      { date: "2025-06-11", followers: 1944, xp: 100 },
      { date: "2025-06-12", followers: 1946, xp: 2000 },
      { date: "2025-06-13", followers: 1950, xp: 100 },
      { date: "2025-06-14", followers: 1961, xp: 10 },
      { date: "2025-06-15", followers: 1972, xp: 27000 },
      { date: "2025-06-16", followers: 1980, xp: 10 },
      { date: "2025-06-17", followers: 1989, xp: 120 },
      { date: "2025-06-18", followers: 1993, xp: 400 },
      { date: "2025-06-19", followers: 1994, xp: 10 },
      { date: "2025-06-20", followers: 1996, xp: 1700 },
      { date: "2025-06-21", followers: 2005, xp: 500 },
      { date: "2025-06-22", followers: 2020, xp: 10 },
      { date: "2025-06-23", followers: 2027, xp: 1000 },
      { date: "2025-06-24", followers: 2037, xp: 900 },
      { date: "2025-06-25", followers: 2045, xp: 10 },
      { date: "2025-06-26", followers: 2056, xp: 250 },
      { date: "2025-06-27", followers: 2067, xp: 20000 },
      { date: "2025-06-28", followers: 2075, xp: 42000 },
      { date: "2025-06-29", followers: 2078, xp: 38600 },
      { date: "2025-06-30", followers: 2082, xp: 37000 },
      { date: "2025-07-01", followers: 2092, xp: 63000 },
      { date: "2025-07-02", followers: 2098, xp: 54000 },
      { date: "2025-07-03", followers: 2105, xp: 59000 },
      { date: "2025-07-04", followers: 2111, xp: 30000 },
      { date: "2025-07-05", followers: 2121, xp: 57000 },
      { date: "2025-07-06", followers: 2127, xp: 58000 },
      { date: "2025-07-07", followers: 2133, xp: 47000 },
      { date: "2025-07-08", followers: 2140, xp: 27700 },
      { date: "2025-07-09", followers: 2147, xp: 30000 },
      { date: "2025-07-10", followers: 2154, xp: 55000 },
      { date: "2025-07-11", followers: 2163, xp: 58000 },
      { date: "2025-07-12", followers: 2170, xp: 30000 },
      { date: "2025-07-13", followers: 2175, xp: 27000 },
      { date: "2025-07-14", followers: 2176, xp: 28000 },
      { date: "2025-07-15", followers: 2177, xp: 30000 },
      { date: "2025-07-16", followers: 2178, xp: 27500 },
      { date: "2025-07-17", followers: 2180, xp: 27600 },
      { date: "2025-07-18", followers: 2182, xp: 29725 },
      { date: "2025-07-19", followers: 2184, xp: 26000 },
      { date: "2025-07-20", followers: 2192, xp: 0 },
      { date: "2025-07-21", followers: 2197, xp: 30000 },
      { date: "2025-07-22", followers: 2198, xp: 55000 },
      { date: "2025-07-23", followers: 2199, xp: 56839 },
      { date: "2025-07-24", followers: 2198, xp: 74220 },
      { date: "2025-07-25", followers: 2213, xp: 60000 },
      { date: "2025-07-26", followers: 2227, xp: 55000 },
      { date: "2025-07-27", followers: 2242, xp: 52000 },
      { date: "2025-07-28", followers: 2246, xp: 73000 },
      { date: "2025-07-29", followers: 2252, xp: 57000 },
      { date: "2025-07-30", followers: 2260, xp: 53405 },
      { date: "2025-07-31", followers: 2266, xp: 60120 },
      { date: "2025-08-01", followers: 2272, xp: 55000 },
      { date: "2025-08-02", followers: 2275, xp: 52000 },
      { date: "2025-08-03", followers: 2280, xp: 54280 },
      { date: "2025-08-04", followers: 2289, xp: 57000 },
      { date: "2025-08-05", followers: 2293, xp: 44170 },
      { date: "2025-08-06", followers: 2296, xp: 41390 },
      { date: "2025-08-07", followers: 2302, xp: 35000 },
       { date: "2025-08-08", followers: 2317, xp: 37500 },
               { date: "2025-08-09", followers: 2348, xp: 25165 },
                  { date: "2025-08-10", followers: 2360, xp: 30050 },
                       { date: "2025-08-11", followers: 2367, xp: 34560 },
                         { date: "2025-08-12", followers: 2370, xp: 26040 },
 { date: "2025-08-13", followers: 2375, xp: 36630 },
  { date: "2025-08-14", followers: 2379, xp: 27800 },
    { date: "2025-08-15", followers: 2390, xp: 25001 },
     { date: "2025-08-16", followers: 2405, xp: 28150 },
          { date: "2025-08-17", followers: 2415, xp: 25190 },
             { date: "2025-08-18", followers: 2420, xp: 28000 },
                { date: "2025-08-19", followers: 2429, xp: 27090 },
                    { date: "2025-08-20", followers: 2433, xp: 23090 },
                       { date: "2025-08-21", followers: 2435, xp: 24650 },
 { date: "2025-08-22", followers: 2439, xp: 27850 },
     { date: "2025-08-23", followers: 2447, xp: 21900 },
     { date: "2025-08-24", followers: 2450, xp: 23300 },
         { date: "2025-08-25", followers: 2453, xp: 19690 },
                  { date: "2025-08-26", followers: 2456, xp: 24530 },
                         { date: "2025-08-27", followers: 2459, xp: 24320 },
          { date: "2025-08-28", followers: 2463, xp: 24000 },
                    { date: "2025-08-29", followers: 2466, xp: 21000 },
                         { date: "2025-08-30", followers: 2467, xp: 22000 },
                           { date: "2025-08-31", followers: 2469, xp: 21500 },
                             { date: "2025-09-1", followers: 2476, xp: 18017 },
                               { date: "2025-09-2", followers: 2478, xp: 22039 },
                                 { date: "2025-09-3", followers: 2478, xp: 24987 },
                                   { date: "2025-09-4", followers: 2483, xp: 22000 },
                                      { date: "2025-09-5", followers: 2490, xp: 25000 },
    { date: "2025-09-6", followers: 2494, xp: 21200 },
    { date: "2025-09-7", followers: 2499, xp: 27000 },
     { date: "2025-09-8", followers: 2506, xp: 22000 },
     { date: "2025-09-9", followers: 2507, xp: 28000 },
       { date: "2025-09-10", followers: 2511, xp: 22000 },
         { date: "2025-09-11", followers: 2516, xp: 19258 },
          { date: "2025-09-12", followers: 2523, xp: 17100 },
           { date: "2025-09-13", followers: 2527, xp: 20000 },
            { date: "2025-09-14", followers: 2525, xp: 35000 },
             { date: "2025-09-15", followers: 2531, xp: 28000 },
                { date: "2025-09-16", followers: 2541, xp: 28050 },
                   { date: "2025-09-17", followers: 2551, xp: 22320 },
                     { date: "2025-09-18", followers: 2555, xp: 24320 },
                   { date: "2025-09-19", followers: 2560, xp: 21200 },
                            { date: "2025-09-20", followers: 2566, xp: 17050 },
                             
                             { date: "2025-09-21", followers: 2568, xp: 21050 },
                                { date: "2025-09-22", followers: 2571, xp: 20050 },
                             { date: "2025-09-23", followers: 2575, xp: 22050 },
                                 { date: "2025-09-24", followers: 2577, xp: 27050 },
                                   { date: "2025-09-25", followers: 2579, xp: 24000 },
                                     { date: "2025-09-26", followers: 2580, xp: 27000 },
                                       { date: "2025-09-27", followers: 2588, xp: 21000 },
{ date: "2025-09-28", followers: 2593, xp: 64 },
{ date: "2025-09-29", followers: 2597, xp: 24100 },
{ date: "2025-09-30", followers: 2603, xp: 28000 },
{ date: "2025-10-1", followers: 2609, xp: 1000 },
{ date: "2025-10-2", followers: 2617, xp: 10020 },
{ date: "2025-10-3", followers: 2623, xp: 22000 },
{ date: "2025-10-4", followers: 2633, xp: 25000 },
{ date: "2025-10-5", followers: 2645, xp: 150 },
{ date: "2025-10-6", followers: 2657, xp: 27000 },
{ date: "2025-10-7", followers: 2659, xp: 26000 },
{ date: "2025-10-8", followers: 2660, xp: 22500 },
{ date: "2025-10-9", followers: 2667, xp: 28000 },
{ date: "2025-10-10", followers: 2668, xp: 30000 },
{ date: "2025-10-11", followers: 2669, xp: 20 },
{ date: "2025-10-12", followers: 2670, xp: 25000 },
{ date: "2025-10-13", followers: 2679, xp: 35000 },
{ date: "2025-10-14", followers: 2683, xp: 28000 },
{ date: "2025-10-15", followers: 2691, xp: 37000 },
{ date: "2025-10-16", followers: 2695, xp: 24000 },
{ date: "2025-10-17", followers: 2698, xp: 30100 },
{ date: "2025-10-18", followers: 2707, xp: 23000 },
{ date: "2025-10-19", followers: 2713, xp: 26000 },
{ date: "2025-10-20", followers: 2719, xp: 27180 },
{ date: "2025-10-21", followers: 2722, xp: 24380 },
{ date: "2025-10-22", followers: 2725, xp: 32000 },
{ date: "2025-10-23", followers: 2728, xp: 30000 },
{ date: "2025-10-24", followers: 2731, xp: 26000 },
{ date: "2025-10-25", followers: 2737, xp: 23000 },

{ date: "2025-10-26", followers: 2740, xp: 32000 },
{ date: "2025-10-27", followers: 2743, xp: 1200 },
{ date: "2025-10-28", followers: 2747, xp: 41 },
{ date: "2025-10-29", followers: 2751, xp: 17000 },
{ date: "2025-10-30", followers: 2755, xp: 49 },
{ date: "2025-10-31", followers: 2760, xp: 21 },

{ date: "2025-11-01", followers: 2765, xp: 36 },
{ date: "2025-11-02", followers: 2770, xp: 14 },
{ date: "2025-11-03", followers: 2776, xp: 45 },
{ date: "2025-11-04", followers: 2781, xp: 29 },
{ date: "2025-11-05", followers: 2787, xp: 50 },
{ date: "2025-11-06", followers: 2793, xp: 19 },
{ date: "2025-11-07", followers: 2798, xp: 33 },
{ date: "2025-11-08", followers: 2804, xp: 24 },
{ date: "2025-11-09", followers: 2810, xp: 47 },
{ date: "2025-11-10", followers: 2816, xp: 8 },
{ date: "2025-11-11", followers: 2822, xp: 38 },
{ date: "2025-11-12", followers: 2828, xp: 22 },
{ date: "2025-11-13", followers: 2831, xp: 44 },
{ date: "2025-11-14", followers: 2836, xp: 28 },
{ date: "2025-11-15", followers: 2844, xp: 35 },
{ date: "2025-11-16", followers: 2846, xp: 17 },
{ date: "2025-11-17", followers: 2856, xp: 49 },
{ date: "2025-11-18", followers: 2860, xp: 26 },
{ date: "2025-11-19", followers: 2869, xp: 41 },
{ date: "2025-11-20", followers: 2871, xp: 20 },
{ date: "2025-11-21", followers: 2878, xp: 34 },
{ date: "2025-11-22", followers: 2880, xp: 15 },
{ date: "2025-11-23", followers: 2891, xp: 46 },
{ date: "2025-11-24", followers: 2896, xp: 0 },
{ date: "2025-11-25", followers: 2903, xp: 39 },
{ date: "2025-11-26", followers: 2905, xp: 23 },
{ date: "2025-11-27", followers: 2916, xp: 48 },
{ date: "2025-11-28", followers: 2919, xp: 18 },
{ date: "2025-11-29", followers: 2928, xp: 42 },
{ date: "2025-11-30", followers: 2932, xp: 27 },

{ date: "2025-12-01", followers: 2938, xp: 34 },
{ date: "2025-12-02", followers: 2940, xp: 21 },
{ date: "2025-12-03", followers: 2951, xp: 50 },
{ date: "2025-12-04", followers: 2954, xp: 25 },
{ date: "2025-12-05", followers: 2962, xp: 37 },
{ date: "2025-12-06", followers: 2964, xp: 16 },
{ date: "2025-12-07", followers: 2974, xp: 44 },
{ date: "2025-12-08", followers: 2978, xp: 29 },
{ date: "2025-12-09", followers: 2986, xp: 10 },
{ date: "2025-12-10", followers: 2988, xp: 22 },
{ date: "2025-12-11", followers: 2995, xp: 35 },
{ date: "2025-12-12", followers: 2997, xp: 19 },
{ date: "2025-12-13", followers: 3006, xp: 47 },
{ date: "2025-12-14", followers: 3009, xp: 24 },
{ date: "2025-12-15", followers: 3014, xp: 31 },

{ date: "2025-12-16", followers: 3014, xp: 24 },
{ date: "2025-12-17", followers: 3015, xp: 47 },
{ date: "2025-12-18", followers: 3015, xp: 18 },
{ date: "2025-12-19", followers: 3017, xp: 39 },
{ date: "2025-12-20", followers: 3017, xp: 22 },
{ date: "2025-12-21", followers: 3019, xp: 0 },
{ date: "2025-12-22", followers: 3019, xp: 0 },
{ date: "2025-12-23", followers: 3020, xp: 27000 },
{ date: "2025-12-24", followers: 3020, xp: 41 },
{ date: "2025-12-25", followers: 3021, xp: 27 },
{ date: "2025-12-26", followers: 3022, xp: 44 },
{ date: "2025-12-27", followers: 3022, xp: 19 },

{ date: "2025-12-28", followers: 3023, xp: 10 },


{ date: "2025-12-29", followers: 3025, xp: 50 },
{ date: "2025-12-30", followers: 3060, xp: 10 },
{ date: "2025-12-31", followers: 3120, xp: 50 },

{ date: "2026-01-01", followers: 3170, xp: 20 },
{ date: "2026-01-02", followers: 3190, xp: 500 },
{ date: "2026-01-03", followers: 3198, xp: 80 },
{ date: "2026-01-04", followers: 3207, xp: 40 },
{ date: "2026-01-05", followers: 3207, xp: 5000 },
{ date: "2026-01-06", followers: 3207, xp: 2000 },
{ date: "2026-01-07", followers: 3206, xp: 4500 },
{ date: "2026-01-08", followers: 3205, xp: 3500 },
{ date: "2026-01-09", followers: 3217, xp: 8500 },
{ date: "2026-01-10", followers: 3240, xp: 10500 },
{ date: "2026-01-11", followers: 3325, xp: 11000 },
{ date: "2026-01-12", followers: 3420, xp: 14600 },
{ date: "2026-01-13", followers: 3475, xp: 16600 },
{ date: "2026-01-14", followers: 3496, xp: 14000 },
{ date: "2026-01-15", followers: 3507, xp: 11000 },
{ date: "2026-01-16", followers: 3511, xp: 7000 },
{ date: "2026-01-17", followers: 3527, xp: 7000 },
{ date: "2026-01-18", followers: 3555, xp: 17000 },
{ date: "2026-01-19", followers: 3574, xp: 11000 },
{ date: "2026-01-20", followers: 3590, xp: 14000 },
{ date: "2026-01-21", followers: 3607, xp: 19000 },
{ date: "2026-01-22", followers: 3633, xp: 15000 },
{ date: "2026-01-23", followers: 3630, xp: 12000 },
{ date: "2026-01-24", followers: 3633, xp: 11111 },
{ date: "2026-01-25", followers: 3643, xp: 9000 },
{ date: "2026-01-26", followers: 3650, xp: 20000 },
{ date: "2026-01-27", followers: 3658, xp: 10000 },
{ date: "2026-01-28", followers: 3668, xp: 7000 },
        ];
//5k  Mar 31, 2026


        // Enhanced Data Processing
        let processedData = [];
        let currentStreak = 0;
        let longestStreak = 0;
        let totalXP = 0;
        let totalFollowersGain = 0;
        let bestDayXP = 0;
        let activeDays = 0;
        let streakFreezesUsed = 0;
        let heatmapType = 'xp';
        let selectedMonth = null;
        let predictionDays = 30;
        let achievementType = 'xp';
        
        // Enhanced data processing
        function processData() {
            processedData = [];
            currentStreak = 0;
            longestStreak = 0;
            totalXP = 0;
            totalFollowersGain = 0;
            bestDayXP = 0;
            activeDays = 0;
            streakFreezesUsed = 0;
            let tempStreak = 0;
            
            // Sort data by date
            const sortedData = [...rawData].sort((a, b) => new Date(a.date) - new Date(b.date));
            
            for (let i = 0; i < sortedData.length; i++) {
                const item = {...sortedData[i]};
                const prevItem = i > 0 ? sortedData[i-1] : null;
                const itemDate = new Date(item.date);
                
                // Calculate followers change
                item.followersChange = prevItem ? item.followers - prevItem.followers : 0;
                totalFollowersGain += item.followersChange > 0 ? item.followersChange : 0;
                
                // Calculate XP level based on cumulative XP
                totalXP += item.xp;
                item.cumulativeXP = totalXP;
                
                // Enhanced streak logic
                if (item.xp > 0) {
                    tempStreak++;
                    activeDays++;
                } else {
                    // Check if this is a streak freeze (0 XP but streak continues)
                    if (tempStreak > 0) {
                        streakFreezesUsed++;
                    }
                }
                
                // Update current streak
                if (i === sortedData.length - 1) {
                    currentStreak = tempStreak;
                }
                
                // Update longest streak
                if (tempStreak > longestStreak) {
                    longestStreak = tempStreak;
                }
                
                // Check for best day XP
                if (item.xp > bestDayXP) bestDayXP = item.xp;
                
                // Calculate XP level
                item.xpLevel = Math.floor(item.cumulativeXP / 1000) + 1;
                
                // Determine status
                if (item.xp === 0) {
                    item.status = 'streak_freeze';
                } else if (item.xp < 20) {
                    item.status = 'low';
                } else if (item.xp < 100) {
                    item.status = 'medium';
                } else if (item.xp < 1000) {
                    item.status = 'high';
                } else {
                    item.status = 'excellent';
                }
                
                // Streak day for this specific day
                item.streakDay = tempStreak;
                
                // Calculate activity score
                item.activityScore = calculateActivityScore(item);
                
                // Add month and year for filtering
                item.month = itemDate.getMonth();
                item.year = itemDate.getFullYear();
                item.monthName = itemDate.toLocaleDateString('en-US', { month: 'long' });
                item.monthYear = itemDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' });
                
                processedData.push(item);
            }
        }

        // Calculate activity score based on your specified logic
        function calculateActivityScore(item) {
            let score = 0;
            
            // XP component (max 50 points)
            if (item.xp === 0) {
                score += 0;
            } else if (item.xp <= 1000) {
                score += 25; // Low
            } else if (item.xp <= 7000) {
                score += 35; // Medium
            } else if (item.xp <= 20000) {
                score += 45; // High
            } else {
                score += 50; // Peak
            }
            
            // Followers component (max 50 points)
            if (item.followersChange < 0) {
                score += 0; // Downfall
            } else if (item.followersChange === 0) {
                score += 10; // No activity
            } else if (item.followersChange <= 7) {
                score += 25; // Low
            } else if (item.followersChange <= 20) {
                score += 35; // Medium
            } else if (item.followersChange <= 50) {
                score += 45; // High
            } else {
                score += 50; // Peak
            }
            
            return score;
        }

        // Initialize
        processData();

        // Chart instances
        let followersChart, xpChart, streakChart, comparativeChart, predictionChart;
        let currentDateRange = 'lifetime';
        let currentSortColumn = 'date';
        let currentSortDirection = 'desc';
        let tableSearchTerm = '';

        // Theme toggle
        const themeToggle = document.getElementById('themeToggle');
        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('light-theme');
            themeToggle.classList.toggle('active');
            updateChartThemes();
        });

        // Update chart themes
        function updateChartThemes() {
            const isLight = document.body.classList.contains('light-theme');
            const gridColor = isLight ? 'rgba(0, 0, 0, 0.1)' : 'rgba(255, 255, 255, 0.1)';
            const textColor = isLight ? '#1E293B' : '#E2E8F0';
            
            [followersChart, xpChart, streakChart, comparativeChart, predictionChart].forEach(chart => {
                if (chart) {
                    chart.options.scales.x.grid.color = gridColor;
                    chart.options.scales.y.grid.color = gridColor;
                    chart.options.scales.x.ticks.color = textColor;
                    chart.options.scales.y.ticks.color = textColor;
                    if (chart.options.plugins && chart.options.plugins.legend) {
                        chart.options.plugins.legend.labels.color = textColor;
                    }
                    chart.update();
                }
            });
        }

        // Date range selector
        document.querySelectorAll('.date-range-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const container = this.closest('.date-range-selector');
                if (container) {
                    container.querySelectorAll('.date-range-btn').forEach(b => b.classList.remove('active'));
                }
                this.classList.add('active');
                currentDateRange = this.dataset.range;
                updateCharts();
                updateTable();
                updateStats();
                updateAdvancedAnalytics();
                if (document.getElementById('heatmapTab').classList.contains('active')) {
                    generateHeatmap();
                }
            });
        });

        // Chart type switcher
        document.querySelectorAll('.chart-type-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                if (!this.dataset.chart) return;
                
                const chartId = this.dataset.chart;
                const chartType = this.dataset.type;
                
                // Update button states
                this.parentElement.querySelectorAll('.chart-type-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                // Update chart type
                switch(chartId) {
                    case 'followers':
                        followersChart.config.type = chartType;
                        followersChart.update();
                        break;
                    case 'xp':
                        xpChart.config.type = chartType;
                        xpChart.update();
                        break;
                    case 'streak':
                        streakChart.config.type = chartType;
                        streakChart.update();
                        break;
                    case 'comparative':
                        comparativeChart.config.type = chartType;
                        comparativeChart.update();
                        break;
                }
            });
        });

        // Heatmap type switcher
        document.querySelectorAll('[data-heatmap-type]').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('[data-heatmap-type]').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                heatmapType = this.dataset.heatmapType;
                generateHeatmap();
            });
        });

        // Prediction type switcher
        document.querySelectorAll('[data-prediction-type]').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('[data-prediction-type]').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                predictionDays = parseInt(this.dataset.predictionType);
                updatePredictions();
            });
        });

        // Achievement type switcher
        document.querySelectorAll('[data-achievement-type]').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('[data-achievement-type]').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                achievementType = this.dataset.achievementType;
                createAchievements();
            });
        });

        // Tab switching
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const tabId = this.dataset.tab;
                
                // Update tab buttons
                this.parentElement.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                // Update tab content
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById(tabId + 'Tab').classList.add('active');
                
                // Initialize tab content
                switch(tabId) {
                    case 'heatmap':
                        generateHeatmap();
                        break;
                    case 'progress':
                        generateProgressionPath();
                        generateAccelerationAnalysis();
                        break;
                    case 'predictions':
                        updatePredictions();
                        break;
                    case 'analytics':
                        updateAdvancedAnalytics();
                        break;
                }
            });
        });

        // Filter data based on date range
        function getFilteredData() {
            const now = new Date();
            let filteredData = [...processedData];
            
            switch(currentDateRange) {
                case 'weekly':
                    const weekAgo = new Date();
                    weekAgo.setDate(weekAgo.getDate() - 7);
                    filteredData = processedData.filter(d => new Date(d.date) >= weekAgo);
                    break;
                case 'monthly':
                    const monthAgo = new Date();
                    monthAgo.setDate(monthAgo.getDate() - 30);
                    filteredData = processedData.filter(d => new Date(d.date) >= monthAgo);
                    break;
                case 'yearly':
                    const yearAgo = new Date();
                    yearAgo.setDate(yearAgo.getDate() - 365);
                    filteredData = processedData.filter(d => new Date(d.date) >= yearAgo);
                    break;
                // 'lifetime' uses all data
            }
            
            return filteredData;
        }

        // Get period label
        function getPeriodLabel() {
            switch(currentDateRange) {
                case 'weekly': return 'this week';
                case 'monthly': return 'this month';
                case 'yearly': return 'this year';
                case 'lifetime': return 'total';
                default: return 'this period';
            }
        }

        // Update stats display
        function updateStats() {
            const filteredData = getFilteredData();
            
            if (filteredData.length === 0) {
                // Handle empty data
                document.getElementById('totalFollowers').textContent = '0';
                document.getElementById('followersChange').textContent = '+0';
                document.getElementById('totalXP').textContent = '0';
                document.getElementById('xpChange').textContent = '+0';
                document.getElementById('activeStreak').textContent = '0';
                document.getElementById('streakChange').textContent = '+0';
                return;
            }
            
            const firstItem = filteredData[0];
            const lastItem = filteredData[filteredData.length - 1];
            
            // Calculate changes
            const followersChange = lastItem.followers - firstItem.followers;
            const xpChange = lastItem.cumulativeXP - (firstItem.cumulativeXP - firstItem.xp);
            const streakChange = currentStreak;
            
            // Update followers stats
            document.getElementById('totalFollowers').textContent = lastItem.followers.toLocaleString();
            document.getElementById('followersChange').textContent = (followersChange >= 0 ? '+' : '') + followersChange.toLocaleString();
            document.getElementById('followersPeriod').textContent = getPeriodLabel();
            
            // Update XP stats
            document.getElementById('totalXP').textContent = lastItem.cumulativeXP.toLocaleString();
            document.getElementById('xpChange').textContent = (xpChange >= 0 ? '+' : '') + xpChange.toLocaleString();
            document.getElementById('xpPeriod').textContent = getPeriodLabel();
            
            // Update streak stats
            document.getElementById('activeStreak').textContent = currentStreak;
            document.getElementById('streakChange').textContent = '+' + streakChange;
            document.getElementById('streakPeriod').textContent = getPeriodLabel();
            
            // Update achievement count
            document.getElementById('achievementsCount').textContent = '18/45';
            
            // Update stat change colors based on positivity
            updateStatChangeColor('followersChangeContainer', followersChange >= 0);
            updateStatChangeColor('xpChangeContainer', xpChange >= 0);
            updateStatChangeColor('streakChangeContainer', streakChange >= 0);
            
            // Quick stats
            const avgXP = filteredData.length > 0 ? 
                Math.round(filteredData.reduce((sum, item) => sum + item.xp, 0) / filteredData.length) : 0;
            
            document.getElementById('currentStreak').textContent = currentStreak + ' days';
            document.getElementById('maxStreak').textContent = longestStreak + ' days';
            document.getElementById('avgXP').textContent = avgXP.toLocaleString();
            document.getElementById('totalFollowersGain').textContent = totalFollowersGain.toLocaleString();
            document.getElementById('bestDayXP').textContent = bestDayXP.toLocaleString();
            document.getElementById('streakFreezes').textContent = streakFreezesUsed;
            
            // Streak display
            document.getElementById('currentStreakDisplay').textContent = currentStreak;
            document.getElementById('longestStreakDisplay').textContent = longestStreak;
            document.getElementById('totalActiveDays').textContent = activeDays;
            const consistencyScore = processedData.length > 0 ? Math.round((activeDays / processedData.length) * 100) : 0;
            document.getElementById('consistencyScore').textContent = consistencyScore + '%';
            
            // Update data count in footer
            document.getElementById('dataCount').textContent = processedData.length;
            document.getElementById('currentDate').textContent = new Date().toLocaleDateString('en-US', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
        }

        // Update stat change color
        function updateStatChangeColor(containerId, isPositive) {
            const container = document.getElementById(containerId);
            const icon = container.querySelector('i');
            const valueSpan = container.querySelector('.stat-change-value');
            
            container.className = isPositive ? 'stat-change positive' : 'stat-change negative';
            icon.className = isPositive ? 'fas fa-arrow-up' : 'fas fa-arrow-down';
            
            // Update color of the value span
            valueSpan.style.color = isPositive ? 'var(--success-color)' : 'var(--danger-color)';
        }

        // Update advanced analytics
        function updateAdvancedAnalytics() {
            const filteredData = getFilteredData();
            
            if (filteredData.length === 0) {
                // Handle empty data
                updateProgressRing('dailyConsistency', 0);
                updateProgressRing('growthRate', 0);
                updateProgressRing('xpEfficiency', 0);
                return;
            }
            
            // Calculate daily consistency
            const activeDaysFiltered = filteredData.filter(d => d.xp > 0).length;
            const dailyConsistency = filteredData.length > 0 ? Math.round((activeDaysFiltered / filteredData.length) * 100) : 0;
            
            // Calculate growth rate
            const firstFollowers = filteredData[0].followers;
            const lastFollowers = filteredData[filteredData.length - 1].followers;
            const growthRate = firstFollowers > 0 ? (((lastFollowers - firstFollowers) / firstFollowers) * 100).toFixed(1) : 0;
            
            // Calculate XP efficiency (XP per follower)
            const totalXPFiltered = filteredData.reduce((sum, item) => sum + item.xp, 0);
            const avgFollowers = filteredData.reduce((sum, item) => sum + item.followers, 0) / filteredData.length;
            const xpEfficiency = avgFollowers > 0 ? Math.round(totalXPFiltered / avgFollowers) : 0;
            
            // Update progress rings
            updateProgressRing('dailyConsistency', dailyConsistency);
            updateProgressRing('growthRate', Math.min(100, growthRate));
            updateProgressRing('xpEfficiency', Math.min(100, xpEfficiency / 10));
            
            // Update streak freezes
            const streakFreezesFiltered = filteredData.filter(d => d.xp === 0 && d.streakDay > 0).length;
            const streakFreezePercentage = filteredData.length > 0 ? Math.round((streakFreezesFiltered / filteredData.length) * 100) : 0;
            
            document.getElementById('streakFreezeCount').textContent = streakFreezesFiltered;
            document.getElementById('streakFreezeBar').style.width = streakFreezePercentage + '%';
            document.getElementById('streakFreezePercentage').textContent = streakFreezePercentage + '% of selected period';
            
            // Generate insights
            generateInsights();
            
            // Generate month-over-month analysis
            generateMonthlyAnalysis();
        }

        // Generate month-over-month analysis
        function generateMonthlyAnalysis() {
            const container = document.getElementById('monthlyAnalysisBody');
            container.innerHTML = '';
            
            // Group data by month
            const monthlyData = {};
            processedData.forEach(item => {
                const date = new Date(item.date);
                const monthYear = `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, '0')}`;
                const monthName = date.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
                
                if (!monthlyData[monthYear]) {
                    monthlyData[monthYear] = {
                        month: monthName,
                        xpData: [],
                        followersData: [],
                        activeDays: 0,
                        maxStreak: 0
                    };
                }
                
                monthlyData[monthYear].xpData.push(item.xp);
                monthlyData[monthYear].followersData.push(item.followers);
                if (item.xp > 0) monthlyData[monthYear].activeDays++;
                if (item.streakDay > monthlyData[monthYear].maxStreak) {
                    monthlyData[monthYear].maxStreak = item.streakDay;
                }
            });
            
            // Sort months and get last 12
            const sortedMonths = Object.keys(monthlyData).sort().reverse().slice(0, 12);
            
            sortedMonths.forEach((monthKey, index) => {
                const monthData = monthlyData[monthKey];
                const prevMonthKey = sortedMonths[index + 1];
                const prevMonthData = prevMonthKey ? monthlyData[prevMonthKey] : null;
                
                const avgDailyXP = Math.round(monthData.xpData.reduce((a, b) => a + b, 0) / monthData.xpData.length);
                const totalFollowersGain = monthData.followersData.length > 1 ? 
                    monthData.followersData[monthData.followersData.length - 1] - monthData.followersData[0] : 0;
                
                let changeVsPrev = 'N/A';
                let trend = 'neutral';
                
                if (prevMonthData) {
                    const prevAvgDailyXP = Math.round(prevMonthData.xpData.reduce((a, b) => a + b, 0) / prevMonthData.xpData.length);
                    const changePercent = prevAvgDailyXP > 0 ? ((avgDailyXP - prevAvgDailyXP) / prevAvgDailyXP * 100).toFixed(1) : 0;
                    
                    if (changePercent > 10) {
                        trend = 'up';
                        changeVsPrev = `<span class="trend-indicator trend-up">+${changePercent}%</span>`;
                    } else if (changePercent < -10) {
                        trend = 'down';
                        changeVsPrev = `<span class="trend-indicator trend-down">${changePercent}%</span>`;
                    } else {
                        changeVsPrev = `<span class="trend-indicator trend-neutral">${changePercent}%</span>`;
                    }
                }
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${monthData.month}</td>
                    <td>${avgDailyXP.toLocaleString()}</td>
                    <td>${totalFollowersGain > 0 ? '+' : ''}${totalFollowersGain.toLocaleString()}</td>
                    <td>${monthData.activeDays}</td>
                    <td>${monthData.maxStreak}</td>
                    <td><span class="trend-indicator trend-${trend}">${trend === 'up' ? '↑' : trend === 'down' ? '↓' : '→'}</span></td>
                    <td>${changeVsPrev}</td>
                `;
                container.appendChild(row);
            });
        }

        // Update progress ring
        function updateProgressRing(id, percentage) {
            const circle = document.getElementById(id + 'Ring');
            const text = document.getElementById(id + 'Text');
            
            if (circle && text) {
                const circumference = 2 * Math.PI * 45;
                const offset = circumference - (percentage / 100) * circumference;
                
                circle.style.strokeDashoffset = offset;
                text.textContent = Math.round(percentage) + '%';
            }
        }

        // Generate insights
        function generateInsights() {
            const filteredData = getFilteredData();
            const lastMonthData = processedData.slice(-30);
            const prevMonthData = processedData.slice(-60, -30);
            
            if (lastMonthData.length === 0 || prevMonthData.length === 0) {
                return;
            }
            
            const currentAvgXP = lastMonthData.reduce((sum, item) => sum + item.xp, 0) / lastMonthData.length;
            const prevAvgXP = prevMonthData.reduce((sum, item) => sum + item.xp, 0) / prevMonthData.length;
            const xpGrowth = ((currentAvgXP - prevAvgXP) / prevAvgXP * 100).toFixed(1);
            
            const currentAvgFollowers = lastMonthData[lastMonthData.length - 1].followers - lastMonthData[0].followers;
            const prevAvgFollowers = prevMonthData[prevMonthData.length - 1].followers - prevMonthData[0].followers;
            const followersGrowth = ((currentAvgFollowers - prevAvgFollowers) / Math.abs(prevAvgFollowers) * 100).toFixed(1);
            
            const insights = [
                `Current streak: ${currentStreak} days (${currentStreak > 30 ? 'Excellent!' : currentStreak > 7 ? 'Good!' : 'Keep going!'})`,
                `XP growth this month: ${xpGrowth > 0 ? '+' : ''}${xpGrowth}% vs previous month`,
                `Followers growth: ${followersGrowth > 0 ? '+' : ''}${followersGrowth}% vs previous month`,
                `Best performance day: ${bestDayXP.toLocaleString()} XP`,
                `Consistency score: ${Math.round((activeDays / processedData.length) * 100)}% active days`,
                `Trend: ${currentAvgXP > prevAvgXP ? 'Accelerating' : 'Decelerating'} growth pattern detected`
            ];
            
            const container = document.getElementById('analyticsInsights');
            container.innerHTML = '';
            
            insights.forEach(insight => {
                const insightEl = document.createElement('div');
                insightEl.className = 'achievement-card';
                insightEl.style.marginBottom = '15px';
                insightEl.style.padding = '15px';
                insightEl.style.background = 'rgba(255, 255, 255, 0.05)';
                insightEl.style.borderRadius = '10px';
                insightEl.innerHTML = `
                    <div class="achievement-icon" style="background: var(--gradient-info);">
                        <i class="fas fa-lightbulb"></i>
                    </div>
                    <div class="achievement-info">
                        <p>${insight}</p>
                    </div>
                `;
                container.appendChild(insightEl);
            });
        }

        // Generate organized heatmap with month filters
        function generateHeatmap() {
            const container = document.getElementById('heatmapDisplay');
            const monthFilterContainer = document.getElementById('monthFilter');
            const legendContainer = document.getElementById('heatmapLegend');
            
            container.innerHTML = '';
            monthFilterContainer.innerHTML = '';
            legendContainer.innerHTML = '';
            
            // Get unique months from data
            const months = {};
            processedData.forEach(item => {
                const monthKey = item.monthYear;
                if (!months[monthKey]) {
                    months[monthKey] = {
                        name: item.monthName,
                        year: item.year,
                        month: item.month,
                        data: []
                    };
                }
                months[monthKey].data.push(item);
            });
            
            // Sort months chronologically
            const sortedMonths = Object.keys(months).sort((a, b) => {
                const dateA = new Date(months[a].year, months[a].month);
                const dateB = new Date(months[b].year, months[b].month);
                return dateA - dateB;
            });
            
            // Create month filter buttons
            const allButton = document.createElement('button');
            allButton.className = `month-btn ${selectedMonth === null ? 'active' : ''}`;
            allButton.textContent = 'All Months';
            allButton.addEventListener('click', () => {
                selectedMonth = null;
                monthFilterContainer.querySelectorAll('.month-btn').forEach(btn => btn.classList.remove('active'));
                allButton.classList.add('active');
                renderHeatmap(processedData);
            });
            monthFilterContainer.appendChild(allButton);
            
            // Add month buttons
            sortedMonths.forEach(monthKey => {
                const monthData = months[monthKey];
                const button = document.createElement('button');
                button.className = `month-btn ${selectedMonth === monthKey ? 'active' : ''}`;
                button.textContent = monthKey;
                button.addEventListener('click', () => {
                    selectedMonth = monthKey;
                    monthFilterContainer.querySelectorAll('.month-btn').forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    renderHeatmap(monthData.data);
                });
                monthFilterContainer.appendChild(button);
            });
            
            // Determine which data to show
            const dataToShow = selectedMonth ? months[selectedMonth].data : processedData;
            
            // Render heatmap
            renderHeatmap(dataToShow);
            
            // Generate legend
            generateHeatmapLegend();
        }

        // Render heatmap for specific data
        function renderHeatmap(data) {
            const container = document.getElementById('heatmapDisplay');
            container.innerHTML = '';
            
            if (data.length === 0) {
                container.innerHTML = '<p style="text-align: center; padding: 40px; color: var(--text-secondary);">No data available for this period.</p>';
                return;
            }
            
            // Group data by month if showing all data
            if (selectedMonth === null && data.length > 0) {
                // Group by month
                const months = {};
                data.forEach(item => {
                    const monthKey = item.monthYear;
                    if (!months[monthKey]) {
                        months[monthKey] = {
                            name: item.monthName,
                            year: item.year,
                            data: []
                        };
                    }
                    months[monthKey].data.push(item);
                });
                
                // Create heatmap for each month
                Object.keys(months).forEach(monthKey => {
                    const monthData = months[monthKey];
                    const monthHeatmap = createMonthHeatmap(monthData.name, monthData.year, monthData.data);
                    container.appendChild(monthHeatmap);
                });
            } else {
                // Create single month heatmap
                const firstDate = new Date(data[0].date);
                const monthHeatmap = createMonthHeatmap(
                    data[0].monthName,
                    data[0].year,
                    data
                );
                container.appendChild(monthHeatmap);
            }
        }

        // Create month heatmap
        function createMonthHeatmap(monthName, year, monthData) {
            const monthContainer = document.createElement('div');
            monthContainer.className = 'heatmap-month-view';
            
            // Month title
            const title = document.createElement('div');
            title.className = 'heatmap-month-title';
            title.textContent = `${monthName} ${year}`;
            monthContainer.appendChild(title);
            
            // Day of week headers
            const daysOfWeek = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
            daysOfWeek.forEach(day => {
                const dayEl = document.createElement('div');
                dayEl.className = 'heatmap-day-of-week';
                dayEl.textContent = day;
                monthContainer.appendChild(dayEl);
            });
            
            // Create data map for quick lookup
            const dataMap = {};
            monthData.forEach(item => {
                const date = new Date(item.date);
                const day = date.getDate();
                dataMap[day] = item;
            });
            
            // Get first day of month
            const firstDay = new Date(year, monthData[0].month, 1);
            const startingDay = firstDay.getDay(); // 0 = Sunday, 1 = Monday, etc.
            
            // Adjust for Monday start (0 = Monday)
            const adjustedStart = startingDay === 0 ? 6 : startingDay - 1;
            
            // Add empty days for first week
            for (let i = 0; i < adjustedStart; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'heatmap-empty-day';
                monthContainer.appendChild(emptyDay);
            }
            
            // Get days in month
            const daysInMonth = new Date(year, monthData[0].month + 1, 0).getDate();
            
            // Create color scheme based on heatmap type
            const colorScheme = getHeatmapColorScheme();
            
            // Add days
            for (let day = 1; day <= daysInMonth; day++) {
                const dayEl = document.createElement('div');
                dayEl.className = 'heatmap-day';
                
                const dayData = dataMap[day];
                
                if (dayData) {
                    let color = colorScheme.no_activity;
                    let tooltip = `${monthName} ${day}, ${year}: `;
                    
                    if (heatmapType === 'xp') {
                        const value = dayData.xp;
                        tooltip += `${value.toLocaleString()} XP`;
                        
                        if (value === 0) {
                            color = colorScheme.no_activity;
                            tooltip += ' (No Activity)';
                        } else if (value <= 1000) {
                            color = colorScheme.low;
                        } else if (value <= 7000) {
                            color = colorScheme.medium;
                        } else if (value <= 30000) {
                            color = colorScheme.high;
                        } else {
                            color = colorScheme.peak;
                        }
                    } else if (heatmapType === 'followers') {
                        const value = dayData.followersChange;
                        tooltip += `${value >= 0 ? '+' : ''}${value} followers`;
                        
                        if (value < 0) {
                            color = colorScheme.downfall;
                        } else if (value === 0) {
                            color = colorScheme.no_activity;
                        } else if (value <= 7) {
                            color = colorScheme.low;
                        } else if (value <= 20) {
                            color = colorScheme.medium;
                        } else if (value <= 40) {
                            color = colorScheme.high;
                        } else {
                            color = colorScheme.peak;
                        }
                    } else {
                        const value = dayData.activityScore;
                        tooltip += `Activity Score: ${value}/100`;
                        
                        if (value === 0) {
                            color = colorScheme.no_activity;
                        } else if (value <= 20) {
                            color = colorScheme.low;
                        } else if (value <= 40) {
                            color = colorScheme.medium;
                        } else if (value <= 80) {
                            color = colorScheme.high;
                        } else {
                            color = colorScheme.peak;
                        }
                    }
                    
                    if (dayData.xp === 0 && dayData.streakDay > 0) {
                        tooltip += ' (Streak Freeze)';
                    }
                    
                    dayEl.style.background = color;
                    dayEl.setAttribute('data-tooltip', tooltip);
                } else {
                    // No data for this day
                    dayEl.style.background = 'rgba(255, 255, 255, 0.05)';
                    dayEl.setAttribute('data-tooltip', `${monthName} ${day}, ${year}: No data`);
                }
                
                monthContainer.appendChild(dayEl);
            }
            
            return monthContainer;
        }

        // Get heatmap color scheme
        function getHeatmapColorScheme() {
            if (heatmapType === 'xp') {
                return {
                    'no_activity': 'rgba(255, 255, 255, 0.1)',
                    'low': 'rgba(54, 211, 153, 0.3)',
                    'medium': 'rgba(54, 211, 153, 0.6)',
                    'high': 'rgba(54, 211, 153, 0.9)',
                    'peak': 'rgba(108, 99, 255, 0.9)'
                };
            } else if (heatmapType === 'followers') {
                return {
                    'downfall': 'rgba(248, 114, 114, 0.6)',
                    'no_activity': 'rgba(255, 255, 255, 0.1)',
                    'low': 'rgba(58, 191, 248, 0.3)',
                    'medium': 'rgba(58, 191, 248, 0.6)',
                    'high': 'rgba(58, 191, 248, 0.9)',
                    'peak': 'rgba(108, 99, 255, 0.9)'
                };
            } else {
                return {
                    'no_activity': 'rgba(255, 255, 255, 0.1)',
                    'low': 'rgba(251, 189, 35, 0.3)',
                    'medium': 'rgba(251, 189, 35, 0.6)',
                    'high': 'rgba(251, 189, 35, 0.9)',
                    'peak': 'rgba(108, 99, 255, 0.9)'
                };
            }
        }

        // Generate heatmap legend
        function generateHeatmapLegend() {
            const legendContainer = document.getElementById('heatmapLegend');
            const colorScheme = getHeatmapColorScheme();
            
            let legendItems = [];
            
            if (heatmapType === 'xp') {
                legendItems = [
                    { color: colorScheme.no_activity, label: 'No Activity (0 XP)' },
                    { color: colorScheme.low, label: 'Low (1-1,000 XP)' },
                    { color: colorScheme.medium, label: 'Medium (1,001-7,000 XP)' },
                    { color: colorScheme.high, label: 'High (7,001-20,000 XP)' },
                    { color: colorScheme.peak, label: 'Peak (20,000+ XP)' }
                ];
            } else if (heatmapType === 'followers') {
                legendItems = [
                    { color: colorScheme.downfall, label: 'Downfall (< 0)' },
                    { color: colorScheme.no_activity, label: 'No Activity (0)' },
                    { color: colorScheme.low, label: 'Low (1-7)' },
                    { color: colorScheme.medium, label: 'Medium (7-20)' },
                    { color: colorScheme.high, label: 'High (20-50)' },
                    { color: colorScheme.peak, label: 'Peak (50+)' }
                ];
            } else {
                legendItems = [
                    { color: colorScheme.no_activity, label: 'No Activity' },
                    { color: colorScheme.low, label: 'Low (0-20)' },
                    { color: colorScheme.medium, label: 'Medium (20-40)' },
                    { color: colorScheme.high, label: 'High (40-80)' },
                    { color: colorScheme.peak, label: 'Peak (80-100)' }
                ];
            }
            
            legendItems.forEach(item => {
                const legendItem = document.createElement('div');
                legendItem.className = 'heatmap-legend-item';
                legendItem.innerHTML = `
                    <div class="heatmap-legend-color" style="background: ${item.color};"></div>
                    <span>${item.label}</span>
                `;
                legendContainer.appendChild(legendItem);
            });
        }

        // Generate progression path
        function generateProgressionPath() {
            const container = document.getElementById('progressionPath');
            container.innerHTML = '';
            
            // Define XP milestones up to 20,000,000
            const xpMilestones = [
                { xp: 1000, label: 'Beginner', icon: 'fa-seedling' },
                { xp: 30000, label: 'Explorer', icon: 'fa-compass' },
                { xp: 100000, label: 'Adventurer', icon: 'fa-mountain' },
                { xp: 500000, label: 'Warrior', icon: 'fa-shield' },
                { xp: 1000000, label: 'Champion', icon: 'fa-trophy' },
                { xp: 2000000, label: 'Master', icon: 'fa-crown' },
                { xp: 5000000, label: 'Legend', icon: 'fa-star' },
                { xp: 7500000, label: 'Mythic', icon: 'fa-dragon' },
                { xp: 10000000, label: 'Titan', icon: 'fa-globe' },
                { xp: 20000000, label: 'Celestial', icon: 'fa-infinity' }
            ];
            
            // Define followers milestones up to 100,000
            const followersMilestones = [
                { followers: 100, label: 'Micro-Influencer', icon: 'fa-users' },
                { followers: 500, label: 'Growing', icon: 'fa-chart-line' },
                { followers: 1000, label: 'Established', icon: 'fa-bullhorn' },
                { followers: 2000, label: 'Influencer', icon: 'fa-fire' },
                { followers: 5000, label: 'Major', icon: 'fa-award' },
                { followers: 10000, label: 'Superstar', icon: 'fa-rocket' },
                         { followers: 20000, label: 'Legend', icon: 'fa-globe' },
                           { followers: 50000, label: 'Celestial', icon: 'fa-crown' },
                             { followers: 100000, label: 'Cant be stopped', icon: 'fa-infinity' },
            ];
            
            const currentXP = processedData[processedData.length - 1].cumulativeXP;
            const currentFollowers = processedData[processedData.length - 1].followers;
            
            // Combine milestones
            const allMilestones = [
                ...xpMilestones.map(m => ({ ...m, type: 'xp' })),
                ...followersMilestones.map(m => ({ ...m, type: 'followers' }))
            ].sort((a, b) => (a.type === 'xp' ? a.xp : a.followers) - (b.type === 'xp' ? b.xp : b.followers));
            
            allMilestones.forEach((milestone, index) => {
                const isXP = milestone.type === 'xp';
                const targetValue = isXP ? milestone.xp : milestone.followers;
                const currentValue = isXP ? currentXP : currentFollowers;
                const progress = Math.min(100, (currentValue / targetValue) * 100);
                const isCompleted = currentValue >= targetValue;
                
                const milestoneEl = document.createElement('div');
                milestoneEl.className = 'achievement-card';
                milestoneEl.style.marginBottom = '20px';
                milestoneEl.innerHTML = `
                    <div class="achievement-icon" style="background: ${isCompleted ? 'var(--gradient-success)' : 'var(--gradient-warning)'};">
                        <i class="fas ${milestone.icon}"></i>
                    </div>
                    <div class="achievement-info" style="flex: 1;">
                        <h4>${milestone.label}</h4>
                        <p>${isXP ? 'XP' : 'Followers'} Milestone: ${targetValue.toLocaleString()}</p>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${progress}%"></div>
                        </div>
                        <small>${currentValue.toLocaleString()} / ${targetValue.toLocaleString()} (${Math.round(progress)}%)</small>
                        ${!isCompleted ? `<small>Estimated completion: ${estimateCompletionDate(targetValue, isXP)}</small>` : ''}
                    </div>
                `;
                container.appendChild(milestoneEl);
            });
        }

        // Generate acceleration analysis
        function generateAccelerationAnalysis() {
            const container = document.getElementById('accelerationAnalysis');
            container.innerHTML = '';
            
            const last30Days = processedData.slice(-30);
            const last90Days = processedData.slice(-90);
            
            // Calculate acceleration metrics
            const xpAcceleration = calculateAcceleration(last30Days, 'xp');
            const followersAcceleration = calculateAcceleration(last30Days, 'followersChange');
            const xpAcceleration90 = calculateAcceleration(last90Days, 'xp');
            
            const analyses = [
                {
                    title: 'XP Acceleration (30 days)',
                    value: `${xpAcceleration > 0 ? '+' : ''}${xpAcceleration.toFixed(1)}%`,
                    description: xpAcceleration > 0 ? 'Accelerating growth' : 'Decelerating growth',
                    icon: 'fa-arrow-up',
                    color: xpAcceleration > 0 ? 'var(--success-color)' : 'var(--danger-color)'
                },
                {
                    title: 'Followers Acceleration (30 days)',
                    value: `${followersAcceleration > 0 ? '+' : ''}${followersAcceleration.toFixed(1)}%`,
                    description: followersAcceleration > 0 ? 'Positive momentum' : 'Negative momentum',
                    icon: 'fa-users',
                    color: followersAcceleration > 0 ? 'var(--success-color)' : 'var(--danger-color)'
                },
                {
                    title: 'Trend Strength',
                    value: `${Math.abs(xpAcceleration - xpAcceleration90).toFixed(1)}%`,
                    description: Math.abs(xpAcceleration - xpAcceleration90) < 20 ? 'Stable trend' : 'Volatile trend',
                    icon: 'fa-chart-line',
                    color: Math.abs(xpAcceleration - xpAcceleration90) < 20 ? 'var(--info-color)' : 'var(--warning-color)'
                }
            ];
            
            analyses.forEach(analysis => {
                const analysisEl = document.createElement('div');
                analysisEl.className = 'achievement-card';
                analysisEl.style.marginBottom = '15px';
                analysisEl.innerHTML = `
                    <div class="achievement-icon" style="background: ${analysis.color}">
                        <i class="fas ${analysis.icon}"></i>
                    </div>
                    <div class="achievement-info" style="flex: 1;">
                        <h4>${analysis.title}</h4>
                        <p>${analysis.value} ${analysis.description}</p>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${Math.min(100, Math.abs(analysis.value))}%"></div>
                        </div>
                        <small>Based on moving average comparison</small>
                    </div>
                `;
                container.appendChild(analysisEl);
            });
        }

        // Calculate acceleration
        function calculateAcceleration(data, key) {
            if (data.length < 10) return 0;
            
            const firstHalf = data.slice(0, Math.floor(data.length / 2));
            const secondHalf = data.slice(Math.floor(data.length / 2));
            
            const avgFirst = firstHalf.reduce((sum, item) => sum + item[key], 0) / firstHalf.length;
            const avgSecond = secondHalf.reduce((sum, item) => sum + item[key], 0) / secondHalf.length;
            
            return ((avgSecond - avgFirst) / Math.abs(avgFirst)) * 100;
        }

        // Update predictions using 30-day averages
        function updatePredictions() {
            // Update prediction cards with 30-day averages
            updatePredictionCards();
            
            // Generate milestone predictions
            generateMilestonePredictions();
            
            // Update prediction chart
            updatePredictionChart();
        }

        // Update prediction cards with 30-day averages
        function updatePredictionCards() {
            const last30Days = processedData.slice(-30);
            
            if (last30Days.length === 0) {
                // Handle empty data
                document.getElementById('prediction30Days').textContent = '0';
                document.getElementById('predictionFollowers30').textContent = '0';
                document.getElementById('predictionXP30').textContent = '0';
                document.getElementById('prediction90Days').textContent = '0';
                document.getElementById('predictionFollowers90').textContent = '0';
                document.getElementById('predictionXP90').textContent = '0';
                document.getElementById('prediction365Days').textContent = '0';
                document.getElementById('predictionFollowers365').textContent = '0';
                document.getElementById('predictionXP365').textContent = '0';
                return;
            }
            
            // Calculate 30-day averages
            const avgDailyXP = last30Days.reduce((sum, item) => sum + item.xp, 0) / last30Days.length;
            const avgDailyFollowersChange = last30Days.reduce((sum, item) => sum + Math.max(0, item.followersChange), 0) / last30Days.length;
            
            // Current values
            const currentFollowers = processedData[processedData.length - 1].followers;
            const currentXP = processedData[processedData.length - 1].cumulativeXP;
            
            // Calculate predictions
            const prediction30Days = Math.round(currentFollowers + (avgDailyFollowersChange * 30));
            const predictionXP30 = Math.round(currentXP + (avgDailyXP * 30));
            
            const prediction90Days = Math.round(currentFollowers + (avgDailyFollowersChange * 90));
            const predictionXP90 = Math.round(currentXP + (avgDailyXP * 90));
            
            const prediction365Days = Math.round(currentFollowers + (avgDailyFollowersChange * 365));
            const predictionXP365 = Math.round(currentXP + (avgDailyXP * 365));
            
            // Update DOM
            document.getElementById('prediction30Days').textContent = prediction30Days.toLocaleString();
            document.getElementById('predictionFollowers30').textContent = Math.round(avgDailyFollowersChange * 30).toLocaleString();
            document.getElementById('predictionXP30').textContent = Math.round(avgDailyXP * 30).toLocaleString();
            
            document.getElementById('prediction90Days').textContent = prediction90Days.toLocaleString();
            document.getElementById('predictionFollowers90').textContent = Math.round(avgDailyFollowersChange * 90).toLocaleString();
            document.getElementById('predictionXP90').textContent = Math.round(avgDailyXP * 90).toLocaleString();
            
            document.getElementById('prediction365Days').textContent = prediction365Days.toLocaleString();
            document.getElementById('predictionFollowers365').textContent = Math.round(avgDailyFollowersChange * 365).toLocaleString();
            document.getElementById('predictionXP365').textContent = Math.round(avgDailyXP * 365).toLocaleString();
        }

        // Generate milestone predictions based on 30-day averages
        function generateMilestonePredictions() {
            const container = document.getElementById('predictiveAnalytics');
            container.innerHTML = '';
            
            const last30Days = processedData.slice(-30);
            
            if (last30Days.length === 0) {
                container.innerHTML = '<p style="text-align: center; padding: 20px; color: var(--text-secondary);">Not enough data for predictions.</p>';
                return;
            }
            
            // Calculate 30-day averages
            const avgDailyXP = last30Days.reduce((sum, item) => sum + item.xp, 0) / last30Days.length;
            const avgDailyFollowersChange = last30Days.reduce((sum, item) => sum + Math.max(0, item.followersChange), 0) / last30Days.length;
            
            const currentXP = processedData[processedData.length - 1].cumulativeXP;
            const currentFollowers = processedData[processedData.length - 1].followers;
            
            // XP milestones up to 20M
            const xpMilestones = [
                { target: 1000000, label: '1 Million XP' },
                { target: 5000000, label: '5 Million XP' },
                { target: 10000000, label: '10 Million XP' },
                { target: 20000000, label: '20 Million XP' }
            ];
            
            // Followers milestones up to 100K
            const followersMilestones = [
                { target: 5000, label: '5,000 Followers' },
                { target: 10000, label: '10,000 Followers' },
                { target: 50000, label: '50,000 Followers' },
                { target: 100000, label: '100,000 Followers' }
            ];
            
            const milestoneEl = document.createElement('div');
            milestoneEl.className = 'achievement-card';
            milestoneEl.style.marginTop = '20px';
            milestoneEl.style.padding = '20px';
            milestoneEl.style.background = 'rgba(255, 255, 255, 0.05)';
            milestoneEl.style.borderRadius = '10px';
            
            let milestoneHTML = '<h4 style="margin-bottom: 15px;">Predicted Milestone Dates (based on 30-day averages):</h4>';
            
            // Calculate XP milestone dates
            milestoneHTML += '<p><strong>XP Milestones:</strong></p>';
            xpMilestones.forEach(milestone => {
                if (currentXP < milestone.target && avgDailyXP > 0) {
                    const daysNeeded = Math.ceil((milestone.target - currentXP) / avgDailyXP);
                    const date = new Date();
                    date.setDate(date.getDate() + daysNeeded);
                    const dateStr = date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
                    milestoneHTML += `<p>• ${milestone.label}: ${dateStr} (in ${daysNeeded} days)</p>`;
                } else if (currentXP >= milestone.target) {
                    milestoneHTML += `<p>• ${milestone.label}: Already achieved!</p>`;
                }
            });
            
            // Calculate followers milestone dates
            milestoneHTML += '<p style="margin-top: 10px;"><strong>Followers Milestones:</strong></p>';
            followersMilestones.forEach(milestone => {
                if (currentFollowers < milestone.target && avgDailyFollowersChange > 0) {
                    const daysNeeded = Math.ceil((milestone.target - currentFollowers) / avgDailyFollowersChange);
                    const date = new Date();
                    date.setDate(date.getDate() + daysNeeded);
                    const dateStr = date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
                    milestoneHTML += `<p>• ${milestone.label}: ${dateStr} (in ${daysNeeded} days)</p>`;
                } else if (currentFollowers >= milestone.target) {
                    milestoneHTML += `<p>• ${milestone.label}: Already achieved!</p>`;
                }
            });
            
            if (avgDailyXP === 0 && avgDailyFollowersChange === 0) {
                milestoneHTML += '<p style="color: var(--text-secondary); margin-top: 10px;">No recent activity data for predictions.</p>';
            }
            
            milestoneEl.innerHTML = milestoneHTML;
            container.appendChild(milestoneEl);
        }

        // Update prediction chart
        function updatePredictionChart() {
            const ctx = document.getElementById('predictionChart');
            if (!ctx) return;
            
            if (predictionChart) predictionChart.destroy();
            
            const last30Days = processedData.slice(-30);
            
            if (last30Days.length === 0) {
                return;
            }
            
            const dates = last30Days.map(d => {
                const date = new Date(d.date);
                return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
            });
            
            // Calculate 30-day averages
            const avgDailyXP = last30Days.reduce((sum, item) => sum + item.xp, 0) / last30Days.length;
            const avgDailyFollowersChange = last30Days.reduce((sum, item) => sum + Math.max(0, item.followersChange), 0) / last30Days.length;
            
            // Current values
            const currentFollowers = processedData[processedData.length - 1].followers;
            const currentXP = processedData[processedData.length - 1].cumulativeXP;
            
            // Generate prediction data
            const predictedDates = [];
            const predictedXP = [];
            const predictedFollowers = [];
            
            for (let i = 0; i <= predictionDays; i++) {
                predictedDates.push(`Day +${i}`);
                predictedXP.push(Math.round(currentXP + (avgDailyXP * i)));
                predictedFollowers.push(Math.round(currentFollowers + (avgDailyFollowersChange * i)));
            }
            
            const isLight = document.body.classList.contains('light-theme');
            const gridColor = isLight ? 'rgba(0, 0, 0, 0.1)' : 'rgba(255, 255, 255, 0.1)';
            const textColor = isLight ? '#1E293B' : '#E2E8F0';
            
            predictionChart = new Chart(ctx.getContext('2d'), {
                type: 'line',
                data: {
                    labels: [...dates, ...predictedDates.slice(1)],
                    datasets: [
                        {
                            label: 'XP (Actual)',
                            data: [...last30Days.map(d => d.cumulativeXP), ...Array(predictionDays).fill(null)],
                            borderColor: 'rgba(54, 211, 153, 1)',
                            backgroundColor: 'rgba(54, 211, 153, 0.2)',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            fill: false
                        },
                        {
                            label: 'XP (Predicted)',
                            data: [...Array(last30Days.length - 1).fill(null), ...predictedXP],
                            borderColor: 'rgba(54, 211, 153, 1)',
                            backgroundColor: 'rgba(54, 211, 153, 0.2)',
                            borderWidth: 3,
                            fill: true
                        },
                        {
                            label: 'Followers (Actual)',
                            data: [...last30Days.map(d => d.followers), ...Array(predictionDays).fill(null)],
                            borderColor: 'rgba(108, 99, 255, 1)',
                            backgroundColor: 'rgba(108, 99, 255, 0.2)',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            fill: false,
                            yAxisID: 'y1'
                        },
                        {
                            label: 'Followers (Predicted)',
                            data: [...Array(last30Days.length - 1).fill(null), ...predictedFollowers],
                            borderColor: 'rgba(108, 99, 255, 1)',
                            backgroundColor: 'rgba(108, 99, 255, 0.2)',
                            borderWidth: 3,
                            fill: true,
                            yAxisID: 'y1'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: { mode: 'index', intersect: false },
                    plugins: {
                        legend: { 
                            labels: { color: textColor }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        label += context.parsed.y.toLocaleString();
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: { color: gridColor },
                            ticks: { color: textColor, maxRotation: 45 }
                        },
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            grid: { color: gridColor },
                            ticks: { color: textColor }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            grid: { drawOnChartArea: false },
                            ticks: { color: textColor }
                        }
                    }
                }
            });
        }

        // Estimate completion date based on 30-day averages
        function estimateCompletionDate(targetValue, isXP) {
            const last30Days = processedData.slice(-30);
            
            if (last30Days.length === 0) return 'Not enough data';
            
            const currentValue = isXP ? 
                processedData[processedData.length - 1].cumulativeXP : 
                processedData[processedData.length - 1].followers;
            
            // Calculate 30-day average
            let avgDailyGain;
            if (isXP) {
                avgDailyGain = last30Days.reduce((sum, item) => sum + item.xp, 0) / last30Days.length;
            } else {
                avgDailyGain = last30Days.reduce((sum, item) => sum + Math.max(0, item.followersChange), 0) / last30Days.length;
            }
            
            if (avgDailyGain <= 0) return 'No recent growth';
            
            const daysNeeded = Math.ceil((targetValue - currentValue) / avgDailyGain);
            
            if (daysNeeded <= 0 || !isFinite(daysNeeded)) return 'Unknown';
            
            const completionDate = new Date();
            completionDate.setDate(completionDate.getDate() + daysNeeded);
            
            return completionDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
        }

        // Table sorting
        function sortTable(column, direction) {
            const filteredData = getFilteredData();
            
            filteredData.sort((a, b) => {
                let valA, valB;
                
                switch(column) {
                    case 'date':
                        valA = new Date(a.date);
                        valB = new Date(b.date);
                        break;
                    case 'followers':
                        valA = a.followers;
                        valB = b.followers;
                        break;
                    case 'followersChange':
                        valA = a.followersChange;
                        valB = b.followersChange;
                        break;
                    case 'xp':
                        valA = a.xp;
                        valB = b.xp;
                        break;
                    case 'xpLevel':
                        valA = a.xpLevel;
                        valB = b.xpLevel;
                        break;
                    case 'streakDay':
                        valA = a.streakDay;
                        valB = b.streakDay;
                        break;
                    case 'status':
                        valA = a.status;
                        valB = b.status;
                        break;
                    case 'activityScore':
                        valA = a.activityScore;
                        valB = b.activityScore;
                        break;
                    default:
                        return 0;
                }
                
                if (direction === 'asc') {
                    return valA > valB ? 1 : -1;
                } else {
                    return valA < valB ? 1 : -1;
                }
            });
            
            return filteredData;
        }

        // Update table with search functionality
        function updateTable() {
            let filteredData = getFilteredData();
            
            // Apply search filter
            if (tableSearchTerm) {
                filteredData = filteredData.filter(item => {
                    const searchLower = tableSearchTerm.toLowerCase();
                    return (
                        item.date.toLowerCase().includes(searchLower) ||
                        item.followers.toString().includes(searchLower) ||
                        item.followersChange.toString().includes(searchLower) ||
                        item.xp.toString().includes(searchLower) ||
                        item.xpLevel.toString().includes(searchLower) ||
                        item.streakDay.toString().includes(searchLower) ||
                        item.status.toLowerCase().includes(searchLower) ||
                        item.activityScore.toString().includes(searchLower)
                    );
                });
            }
            
            // Apply sorting
            filteredData = sortTable(currentSortColumn, currentSortDirection);
            
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';
            
            filteredData.forEach(item => {
                const row = document.createElement('tr');
                
                // Format date
                const dateObj = new Date(item.date);
                const formattedDate = dateObj.toLocaleDateString('en-US', { 
                    weekday: 'short', 
                    year: 'numeric', 
                    month: 'short', 
                    day: 'numeric' 
                });
                
                // Determine status badge
                let statusBadge = '';
                switch(item.status) {
                    case 'streak_freeze':
                        statusBadge = '<span class="trend-indicator trend-neutral">Streak Freeze</span>';
                        break;
                    case 'low':
                        statusBadge = '<span class="trend-indicator trend-neutral">Low</span>';
                        break;
                    case 'medium':
                        statusBadge = '<span class="trend-indicator trend-up">Medium</span>';
                        break;
                    case 'high':
                        statusBadge = '<span class="trend-indicator trend-up">High</span>';
                        break;
                    case 'excellent':
                        statusBadge = '<span class="trend-indicator trend-up pulse">Excellent</span>';
                        break;
                }
                
                row.innerHTML = `
                    <td>${formattedDate}</td>
                    <td>${item.followers.toLocaleString()}</td>
                    <td class="${item.followersChange >= 0 ? 'positive' : 'negative'}">
                        ${item.followersChange >= 0 ? '+' : ''}${item.followersChange}
                    </td>
                    <td><span class="data-point-highlight">${item.xp.toLocaleString()}</span></td>
                    <td>Level ${item.xpLevel}</td>
                    <td>${item.streakDay}</td>
                    <td>${statusBadge}</td>
                    <td>${item.activityScore}/100</td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // Update sort indicators
            document.querySelectorAll('#dataTable th').forEach(th => {
                th.classList.remove('sorted-asc', 'sorted-desc');
                if (th.dataset.sort === currentSortColumn) {
                    th.classList.add(currentSortDirection === 'asc' ? 'sorted-asc' : 'sorted-desc');
                }
            });
        }

        // Create achievements
        function createAchievements() {
            let achievements = [];
            
            // if (achievementType === 'xp') {
            //     achievements = [
            //         { id: 1, title: "First 1,000 XP", desc: "Earn your first 1,000 XP", icon: "fa-star", current: totalXP, target: 1000, color: "var(--warning-color)" },
            //         { id: 2, title: "10K Club", desc: "Reach 10,000 total XP", icon: "fa-bolt", current: totalXP, target: 10000, color: "var(--info-color)" },
            //         { id: 3, title: "100K Master", desc: "Accumulate 100,000 XP", icon: "fa-trophy", current: totalXP, target: 100000, color: "var(--success-color)" },
            //         { id: 4, title: "Millionaire", desc: "Earn 1,000,000 XP", icon: "fa-crown", current: totalXP, target: 1000000, color: "var(--primary-color)" },
            //         { id: 5, title: "10 Million", desc: "Reach 10,000,000 XP", icon: "fa-globe", current: totalXP, target: 10000000, color: "var(--secondary-color)" },
            //         { id: 6, title: "20 Million Elite", desc: "Achieve 20,000,000 XP", icon: "fa-infinity", current: totalXP, target: 20000000, color: "var(--danger-color)" }
            //     ];
            // } else if (achievementType === 'followers') {
            //     achievements = [
            //         { id: 1, title: "First 1,000", desc: "Reach 1,000 followers", icon: "fa-users", current: processedData[processedData.length - 1].followers, target: 1000, color: "var(--warning-color)" },
            //         { id: 2, title: "10K Following", desc: "Gain 10,000 followers", icon: "fa-bullhorn", current: processedData[processedData.length - 1].followers, target: 10000, color: "var(--info-color)" },
            //         { id: 3, title: "50K Influencer", desc: "Reach 50,000 followers", icon: "fa-fire", current: processedData[processedData.length - 1].followers, target: 50000, color: "var(--success-color)" },
            //         { id: 4, title: "100K Superstar", desc: "Achieve 100,000 followers", icon: "fa-rocket", current: processedData[processedData.length - 1].followers, target: 100000, color: "var(--primary-color)" }
            //     ];
            // } else {
            //     achievements = [
            //         { id: 1, title: "7-Day Streak", desc: "Maintain a 7-day streak", icon: "fa-fire", current: currentStreak, target: 7, color: "var(--warning-color)" },
            //         { id: 2, title: "30-Day Master", desc: "Achieve a 30-day streak", icon: "fa-calendar", current: longestStreak, target: 30, color: "var(--info-color)" },
            //         { id: 3, title: "100-Day Legend", desc: "Reach 100 consecutive days", icon: "fa-infinity", current: longestStreak, target: 100, color: "var(--success-color)" },
            //         { id: 4, title: "365-Day Year", desc: "Complete a full year streak", icon: "fa-award", current: longestStreak, target: 365, color: "var(--primary-color)" }
            //     ];
            // }
            












            if (achievementType === 'xp') {
    achievements = [
        { id: 1,  title: "First 1,000 XP",       desc: "Earn your first 1,000 XP",                  icon: "fa-star",       current: totalXP, target: 1000,       color: "var(--warning-color)" },
        { id: 2,  title: "10K Club",             desc: "Reach 10,000 total XP",                    icon: "fa-bolt",       current: totalXP, target: 10000,      color: "var(--info-color)" },
        { id: 3,  title: "50K Grind",            desc: "Accumulate 50,000 XP",                     icon: "fa-fire",       current: totalXP, target: 50000,      color: "var(--orange-color)" },
        { id: 4,  title: "100K Master",          desc: "Reach 100,000 total XP",                   icon: "fa-trophy",     current: totalXP, target: 100000,     color: "var(--success-color)" },
        { id: 5,  title: "500K Veteran",         desc: "Earn 500,000 XP",                          icon: "fa-shield-alt", current: totalXP, target: 500000,     color: "var(--purple-color)" },
        { id: 6,  title: "Millionaire",          desc: "Achieve 1,000,000 XP",                     icon: "fa-crown",      current: totalXP, target: 1000000,    color: "var(--primary-color)" },
        { id: 7,  title: "5 Million Legend",     desc: "Reach 5,000,000 total XP",                 icon: "fa-dragon",     current: totalXP, target: 5000000,    color: "var(--danger-color)" },
        { id: 8,  title: "7,500,000 XP!",       desc: "Earn 7,500,000 XP",                  icon: "fa-globe",       current: totalXP, target: 7500000,       color: "var(--warning-color)" },
        { id: 9,  title: "10 Million Elite",     desc: "Accumulate 10,000,000 XP",                 icon: "fa-globe",      current: totalXP, target: 10000000,   color: "var(--secondary-color)" },
        { id: 10,  title: "20 Million Immortal",  desc: "Earn 20,000,000 XP",                       icon: "fa-infinity",   current: totalXP, target: 20000000,   color: "var(--pink-color)" },


    ];
} 
else if (achievementType === 'followers') {
    achievements = [
        { id: 1, title: "Rising Star",         desc: "First 100 followers",               icon: "fa-users",       current: processedData[processedData.length - 1].followers, target: 100,   color: "var(--warning-color)" },
        { id: 2, title: "1K Crowd",           desc: "Reach 1000 followers",              icon: "fa-bullhorn",    current: processedData[processedData.length - 1].followers, target: 1000,  color: "var(--info-color)" },
        { id: 3, title: "2.5K Influencer",      desc: "Grow to 2,500 followers",            icon: "fa-fire",        current: processedData[processedData.length - 1].followers, target: 2500,  color: "var(--success-color)" },
        { id: 4, title: "5K Verified Vibes", desc: "Hit 5,000 followers",               icon: "fa-rocket",      current: processedData[processedData.length - 1].followers, target: 5000, color: "var(--primary-color)" },
        { id: 5, title: "7.5K Authority",      desc: "Reach 7,500 followers",             icon: "fa-chess-queen", current: processedData[processedData.length - 1].followers, target: 7500, color: "var(--purple-color)" },
        { id: 6, title: "10K Movement",       desc: "Build a 10,000-strong community",    icon: "fa-fist-raised", current: processedData[processedData.length - 1].followers, target: 10000, color: "var(--danger-color)" },
   { id: 7, title: "20K Movement", desc: "Build a 20,000-strong community", icon: "fa-fist-raised", current: processedData[processedData.length - 1].followers, target: 20000, color: "var(--danger-color)" },
{ id: 8, title: "30K Movement", desc: "Build a 30,000-strong community", icon: "fa-fist-raised", current: processedData[processedData.length - 1].followers, target: 30000, color: "var(--danger-color)" },
{ id: 9, title: "50K Movement", desc: "Build a 50,000-strong community", icon: "fa-fist-raised", current: processedData[processedData.length - 1].followers, target: 50000, color: "var(--danger-color)" },
        { id: 10, title: "100k Club",      desc: "Join the 1 lakh follower elite",   icon: "fa-crown",       current: processedData[processedData.length - 1].followers, target: 100000,color: "var(--gold-color)" },
    ];
} 
else {  // streaks
    achievements = [
        { id: 1, title: "First Flame",        desc: "Start a 7-day streak",                     icon: "fa-fire",         current: currentStreak, target: 7,    color: "var(--warning-color)" },
        { id: 2, title: "2-Week Warrior",     desc: "Maintain a 14-day streak",                 icon: "fa-fire-alt",     current: currentStreak, target: 14,   color: "var(--orange-color)" },
        { id: 3, title: "30-Day Master",      desc: "Achieve a 30-day streak",                  icon: "fa-calendar-check", current: longestStreak, target: 30,   color: "var(--info-color)" },
        { id: 4, title: "90-Day Iron Will",   desc: "Keep going for 90 consecutive days",      icon: "fa-shield-virus", current: longestStreak, target: 90,   color: "var(--success-color)" },
        { id: 5, title: "100-Day Legend",     desc: "Reach 100-day streak",                     icon: "fa-bullhorn",     current: longestStreak, target: 100,  color: "var(--purple-color)" },
        { id: 6, title: "Half-Year Champion", desc: "180 days of unbreakable consistency",      icon: "fa-medal",        current: longestStreak, target: 180,  color: "var(--primary-color)" },
        { id: 7, title: "365-Day Year Lord",  desc: "Complete a full 365-day streak",           icon: "fa-crown",        current: longestStreak, target: 365,  color: "var(--gold-color)" },
        { id: 8, title: "500-Day Titan",      desc: "500 days – you're basically a machine",    icon: "fa-robot",        current: longestStreak, target: 500,  color: "var(--danger-color)" },
        { id: 9, title: "1000-Day Eternal",   desc: "1,000 consecutive days of dedication",     icon: "fa-rocket",     current: longestStreak, target: 1000, color: "var(--cyan-color)" },
          { id: 10, title: "2000-Day Eternal",   desc: "2,000 consecutive days of dedication",     icon: "fa-infinity",     current: longestStreak, target: 2000, color: "var(--cyan-color)" }
    ];
}
            
            const container = document.getElementById('achievementsContainer');
            container.innerHTML = '';
            
            achievements.forEach(achievement => {
                const percentage = Math.min(100, (achievement.current / achievement.target) * 100);
                const isCompleted = achievement.current >= achievement.target;
                
                const achievementEl = document.createElement('div');
                achievementEl.className = 'achievement-card';
                achievementEl.innerHTML = `
                    <div class="achievement-icon" style="background: ${isCompleted ? achievement.color : 'rgba(255, 255, 255, 0.1)'}">
                        <i class="fas ${achievement.icon}"></i>
                    </div>
                    <div class="achievement-info">
                        <h4>${achievement.title}</h4>
                        <p>${achievement.desc}</p>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${percentage}%"></div>
                        </div>
                        <small>${achievement.current.toLocaleString()} / ${achievement.target.toLocaleString()} (${Math.round(percentage)}%)</small>
                        ${!isCompleted ? `<small>Estimated: ${estimateCompletionDate(achievement.target, achievementType === 'xp')}</small>` : ''}
                    </div>
                `;
                container.appendChild(achievementEl);
            });
        }

        // Initialize charts
        function initCharts() {
            const filteredData = getFilteredData();
            const dates = filteredData.map(d => {
                const date = new Date(d.date);
                return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
            });
            
            const followers = filteredData.map(d => d.followers);
            const xp = filteredData.map(d => d.xp);
            const cumulativeXP = filteredData.map(d => d.cumulativeXP);
            const streakDays = filteredData.map(d => d.streakDay);
            const followersChange = filteredData.map(d => d.followersChange);
            
            const isLight = document.body.classList.contains('light-theme');
            const gridColor = isLight ? 'rgba(0, 0, 0, 0.1)' : 'rgba(255, 255, 255, 0.1)';
            const textColor = isLight ? '#1E293B' : '#E2E8F0';
            
            // Followers Chart
            const followersCtx = document.getElementById('followersChart').getContext('2d');
            followersChart = new Chart(followersCtx, {
                type: 'line',
                data: {
                    labels: dates,
                    datasets: [{
                        label: 'Followers',
                        data: followers,
                        borderColor: 'rgba(108, 99, 255, 1)',
                        backgroundColor: 'rgba(108, 99, 255, 0.2)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: { mode: 'index', intersect: false }
                    },
                    scales: {
                        x: {
                            grid: { color: gridColor },
                            ticks: { color: textColor, maxRotation: 45 }
                        },
                        y: {
                            grid: { color: gridColor },
                            ticks: { color: textColor }
                        }
                    }
                }
            });
            
            // XP Chart
            const xpCtx = document.getElementById('xpChart').getContext('2d');
            xpChart = new Chart(xpCtx, {
                type: 'line',
                data: {
                    labels: dates,
                    datasets: [
                        {
                            label: 'Daily XP',
                            data: xp,
                            borderColor: 'rgba(54, 211, 153, 1)',
                            backgroundColor: 'rgba(54, 211, 153, 0.2)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'Cumulative XP',
                            data: cumulativeXP,
                            borderColor: 'rgba(58, 191, 248, 1)',
                            backgroundColor: 'rgba(58, 191, 248, 0.2)',
                            borderWidth: 2,
                            fill: false,
                            tension: 0.4,
                            borderDash: [5, 5]
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { 
                            labels: { color: textColor }
                        },
                        tooltip: { mode: 'index', intersect: false }
                    },
                    scales: {
                        x: {
                            grid: { color: gridColor },
                            ticks: { color: textColor, maxRotation: 45 }
                        },
                        y: {
                            grid: { color: gridColor },
                            ticks: { color: textColor }
                        }
                    }
                }
            });
            
            // Streak Chart
            const streakCtx = document.getElementById('streakChart').getContext('2d');
            streakChart = new Chart(streakCtx, {
                type: 'line',
                data: {
                    labels: dates,
                    datasets: [{
                        label: 'Streak Days',
                        data: streakDays,
                        borderColor: 'rgba(251, 189, 35, 1)',
                        backgroundColor: 'rgba(251, 189, 35, 0.2)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: function(context) {
                            const index = context.dataIndex;
                            const value = context.dataset.data[index];
                            const item = filteredData[index];
                            return item.xp === 0 ? 'rgba(248, 114, 114, 1)' : 'rgba(251, 189, 35, 1)';
                        }
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: { 
                            mode: 'index', 
                            intersect: false,
                            callbacks: {
                                label: function(context) {
                                    const item = filteredData[context.dataIndex];
                                    return `Streak: ${context.raw} days${item.xp === 0 ? ' (Streak Freeze)' : ''}`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: { color: gridColor },
                            ticks: { color: textColor, maxRotation: 45 }
                        },
                        y: {
                            grid: { color: gridColor },
                            ticks: { color: textColor }
                        }
                    }
                }
            });
            
            // Comparative Chart
            const comparativeCtx = document.getElementById('comparativeChart').getContext('2d');
            comparativeChart = new Chart(comparativeCtx, {
                type: 'line',
                data: {
                    labels: dates,
                    datasets: [
                        {
                            label: 'Followers Change',
                            data: followersChange,
                            borderColor: 'rgba(108, 99, 255, 1)',
                            backgroundColor: 'rgba(108, 99, 255, 0.2)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            yAxisID: 'y'
                        },
                        {
                            label: 'Daily XP',
                            data: xp,
                            borderColor: 'rgba(54, 211, 153, 1)',
                            backgroundColor: 'rgba(54, 211, 153, 0.2)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            yAxisID: 'y1'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: { mode: 'index', intersect: false },
                    plugins: {
                        legend: { 
                            labels: { color: textColor }
                        }
                    },
                    scales: {
                        x: {
                            grid: { color: gridColor },
                            ticks: { color: textColor, maxRotation: 45 }
                        },
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            grid: { color: gridColor },
                            ticks: { color: textColor }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            grid: { drawOnChartArea: false },
                            ticks: { color: textColor }
                        }
                    }
                }
            });
        }

        // Update all charts
        function updateCharts() {
            if (followersChart) followersChart.destroy();
            if (xpChart) xpChart.destroy();
            if (streakChart) streakChart.destroy();
            if (comparativeChart) comparativeChart.destroy();
            
            initCharts();
        }

        // Toast notification
        function showToast(message, type) {
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.transform = 'translateX(0)';
            }, 10);
            
            setTimeout(() => {
                toast.style.transform = 'translateX(150%)';
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 300);
            }, 3000);
        }

        // Modal handling
        document.getElementById('exportBtn').addEventListener('click', () => {
            document.getElementById('exportModal').classList.add('active');
        });

        document.getElementById('settingsBtn').addEventListener('click', () => {
            document.getElementById('settingsModal').classList.add('active');
        });

        document.getElementById('analyticsBtn').addEventListener('click', () => {
            document.querySelector('[data-tab="analytics"]').click();
        });

        document.getElementById('closeExportModal').addEventListener('click', () => {
            document.getElementById('exportModal').classList.remove('active');
        });

        document.getElementById('closeSettingsModal').addEventListener('click', () => {
            document.getElementById('settingsModal').classList.remove('active');
        });

        // Close modals on outside click
        window.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal')) {
                e.target.classList.remove('active');
            }
        });

        // Export functionality
        document.getElementById('exportCSV').addEventListener('click', () => {
            const filteredData = getFilteredData();
            let csv = 'Date,Followers,Daily Change,XP,XP Level,Streak Day,Status,Activity Score\n';
            
            filteredData.forEach(item => {
                csv += `${item.date},${item.followers},${item.followersChange},${item.xp},${item.xpLevel},${item.streakDay},${item.status},${item.activityScore}\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `analytics-data-${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            
            showToast('Data exported as CSV successfully!', 'success');
        });

        // Table search
        document.getElementById('tableSearch').addEventListener('input', (e) => {
            tableSearchTerm = e.target.value;
            updateTable();
        });

        // Table sorting
        document.querySelectorAll('#dataTable th').forEach(th => {
            th.addEventListener('click', function() {
                const column = this.dataset.sort;
                
                if (currentSortColumn === column) {
                    currentSortDirection = currentSortDirection === 'asc' ? 'desc' : 'asc';
                } else {
                    currentSortColumn = column;
                    currentSortDirection = 'desc';
                }
                
                updateTable();
            });
        });

        // Function to add new data
        function addNewData(newData) {
            // Add new data to rawData
            rawData.push(...newData);
            
            // Process data again
            processData();
            
            // Update all components
            updateStats();
            updateTable();
            updateCharts();
            updateAdvancedAnalytics();
            updatePredictions();
            
            // Update heatmap if active
            if (document.getElementById('heatmapTab').classList.contains('active')) {
                generateHeatmap();
            }
            
            // Update achievements
            createAchievements();
            
            showToast(`${newData.length} new data points added!`, 'success');
        }

        // Initialize everything
        function init() {
            processData();
            updateStats();
            updateTable();
            createAchievements();
            initCharts();
            updateAdvancedAnalytics();
            updatePredictions();
            generateHeatmap();
            
            // Add interaction to buttons
            document.querySelectorAll('.export-btn, .notification-btn, .settings-btn, .analytics-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    this.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        this.style.transform = '';
                    }, 200);
                });
            });
            
            // Notification button click
            document.getElementById('notificationBtn').addEventListener('click', () => {
                showToast('5 new notifications available', 'info');
            });
            
            // Add keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                if (e.ctrlKey && e.key === 'e') {
                    e.preventDefault();
                    document.getElementById('exportBtn').click();
                }
                if (e.ctrlKey && e.key === 's') {
                    e.preventDefault();
                    document.getElementById('settingsBtn').click();
                }
                if (e.ctrlKey && e.key === '/') {
                    e.preventDefault();
                    document.getElementById('tableSearch').focus();
                }
            });
            
            // Example of adding new data (for testing)
            // You can call addNewData() with new data whenever you get updates
            // Example: addNewData([{ date: "2026-01-25", followers: 3650, xp: 15000 }]);
        }

        // Initialize on load
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>